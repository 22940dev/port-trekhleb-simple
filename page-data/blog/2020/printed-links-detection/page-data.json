{"componentChunkName":"component---src-templates-post-tsx","path":"/blog/2020/printed-links-detection/","result":{"data":{"mdx":{"id":"cb56b835-4e5c-5cde-812f-fb9f8cea3170","timeToRead":22,"body":"function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key];}}return target;}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key];}return target;}/* @jsxRuntime classic */ /* @jsx mdx */var _frontmatter={\"title\":\"Making the Printed Links Clickable Using TensorFlow 2 Object Detection API\",\"summary\":\"In this article we will start solving the issue of making the printed links (i.e. in a book or in a magazine) clickable via your smartphone camera\",\"cover\":\"assets/01-cover.png\",\"date\":\"2020-12-01T00:00:00.000Z\"};var layoutProps={_frontmatter:_frontmatter};var MDXLayout=\"wrapper\";return function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,[\"components\"]);return mdx(MDXLayout,_extends({},layoutProps,props,{components:components,mdxType:\"MDXLayout\"}),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"1000px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"50%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACNklEQVQoz3WS20uacRjHzcw2hBEIQdephVDZf6DgVREReBnkxQjC2Katm0VdLBjC6LKNtaib3XS6kFob0x3wsFpjk6FLzMNe9e21A7nVP/DZ689qja2LL9/nuXg+PCeNRqPhf9JqtcI7OztZWFhga2uLeDxOKpUik8mQTCZFvrm5yezsLG63G71eX635A6mrq/sH3N7ezuLiIul0mt3dXUqlEoqiIMsyxWJRQAOBAB6Ph/r6+r+BV8ENDQ0ittlsLC0tIUmSgJyenlKpVFQ/4+SkIpTL5ZmamqKx8bzDpqYmWlpaaG1txWg00t/fz9DQkABarVZCoZCAHB4eCuDx8bGan3B29ouDA4VyeR+/34/BYKgBOzo66OvrY3BwEKfTid1up6en53KH6+vrauEBhYKkjnuELG2T+/qAvc8TJKLjpLbH8U8Pc+PmrRqwu7ubkZERBgYG6O3txeVy4XA4LjtcXl6mVCyQz2dVaJF9OcO+FKWQDZNOBknEXzI54VNXdb7D5uZmAe3q6hIdVWUymQTQbDYzPz9P8nuGvKQgFRTVyxTln+R+HPEtkSUc2cHr9alH0daA1SNU36TqF7FOp6sBLRZmZh6zl9yglA0i59+iSO9UD1HKBckk1gi+fsHo6F215porX5XJbGH64SSxV3f4EBjmU8jLjqov7++z/eYekY3bBFYe4Rn1qUDt9cCLn2xra2NsbIwnT5+xurpGOBwhGo0Ri30kGAyxsrLK3NxzcYPqVL8BuY+/OfUo65cAAAAASUVORK5CYII=')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Links Detector Cover\",\"title\":\"Links Detector Cover\",\"src\":\"/static/745b6101a4bb0c212288c868617942b8/00d43/27.png\",\"srcSet\":[\"/static/745b6101a4bb0c212288c868617942b8/63868/27.png 250w\",\"/static/745b6101a4bb0c212288c868617942b8/0b533/27.png 500w\",\"/static/745b6101a4bb0c212288c868617942b8/00d43/27.png 1000w\",\"/static/745b6101a4bb0c212288c868617942b8/21b4d/27.png 1280w\"],\"sizes\":\"(max-width: 1000px) 100vw, 1000px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"h2\",{\"id\":\"-tldr\",\"style\":{\"position\":\"relative\"}},\"\\uD83D\\uDCC3 TL;DR\",mdx(\"a\",{parentName:\"h2\",\"href\":\"#-tldr\",\"aria-label\":\" tldr permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,mdx(\"em\",{parentName:\"p\"},\"In this article we will start solving the issue of making the printed links (i.e. in a book or in a magazine) clickable via your smartphone camera.\")),mdx(\"p\",null,\"We will use \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/tensorflow/models/tree/master/research/object_detection\"},\"TensorFlow 2 Object Detection API\"),\" to train a custom object detector model to find positions and bounding boxes of the sub-strings like \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"https://\"),\" in the text image (i.e. in smartphone camera stream).\"),mdx(\"p\",null,\"The text of each link (right continuation of \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"https://\"),\" bounding box) will be recognized by using \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://tesseract.projectnaptha.com/\"},\"Tesseract\"),\" library. The recognition part will not be covered in this article, but you may find the complete code example of the application in \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/trekhleb/links-detector\"},\"links-detector repository\"),\".\"),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},\"\\uD83D\\uDE80 \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://trekhleb.dev/links-detector/\"},\"Launch Links Detector demo\"),\" from your smartphone to see the final result.\")),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},\"\\uD83D\\uDCDD \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/trekhleb/links-detector\"},\"Open links-detector repository\"),\" on GitHub to see the complete source code of the application.\")),mdx(\"p\",null,\"Here is how the final solution will look like:\"),mdx(\"p\",null,mdx(\"img\",{parentName:\"p\",\"src\":\"/posts-assets/4e839b39a53cf12e04da75a283aadc60/02-demo.gif\",\"alt\":\"Links Detector Demo\"})),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},\"\\u26A0\\uFE0F Currently the application is in \",mdx(\"em\",{parentName:\"p\"},\"experimental\"),\" \",mdx(\"em\",{parentName:\"p\"},\"Alpha\"),\" stage and has \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/trekhleb/links-detector/issues?q=is%3Aopen+is%3Aissue+label%3Aenhancement\"},\"many issues and limitations\"),\". So don't raise your expectations level too high until these issues are resolved \\uD83E\\uDD37\\uD83C\\uDFFB\\u200D. Also, the purpose of this article is more about learning how to work with TensorFlow 2 Object Detection API rather than coming up with a production-ready model.\")),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},\"In case if Python code blocks in this article will lack proper formatting on this platform feel free to \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/trekhleb/links-detector/blob/master/articles/printed_links_detection/printed_links_detection.md\"},\"to read the article on GitHub\"))),mdx(\"h2\",{\"id\":\"ü§∑Ô∏è-the-problem\",\"style\":{\"position\":\"relative\"}},\"\\uD83E\\uDD37\\uD83C\\uDFFB\\u200D\\uFE0F The Problem\",mdx(\"a\",{parentName:\"h2\",\"href\":\"#%F0%9F%A4%B7%EF%B8%8F-the-problem\",\"aria-label\":\"ü§∑Ô∏è the problem permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"I work as a software engineer and in my own time, I learn Machine Learning as a hobby. But this is not the problem yet.\"),mdx(\"p\",null,\"I bought a printed book about Machine Learning recently and while I was reading through the first several chapters I've encountered many printed links in the text that looked like \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"https://tensorflow.org/\"),\" or \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"https://some-url.com/which/may/be/even/longer?and_with_params=true\"),\".\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"1000px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"43.2%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBP/EABUBAQEAAAAAAAAAAAAAAAAAAAEA/9oADAMBAAIQAxAAAAHSgErR/8QAFhABAQEAAAAAAAAAAAAAAAAAACEg/9oACAEBAAEFAlXH/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGxAAAgEFAAAAAAAAAAAAAAAAAAFBEBExUXH/2gAIAQEAAT8hV90PoggeT//aAAwDAQACAAMAAAAQQN//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAEBAAIDAAAAAAAAAAAAAAABABAhQZGh/9oACAEBAAE/EEgT1OnPcg6jHE//2Q==')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Printed Links\",\"title\":\"Printed Links\",\"src\":\"/static/0c4381cbec209c0614c9a8e89dc64425/a2510/0.jpg\",\"srcSet\":[\"/static/0c4381cbec209c0614c9a8e89dc64425/0479a/0.jpg 250w\",\"/static/0c4381cbec209c0614c9a8e89dc64425/41099/0.jpg 500w\",\"/static/0c4381cbec209c0614c9a8e89dc64425/a2510/0.jpg 1000w\"],\"sizes\":\"(max-width: 1000px) 100vw, 1000px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,\"I saw all these links, but I couldn't click on them since they were printed (thanks, cap!). To visit these links I needed to start typing them character by character in the browser's address bar, which was pretty annoying and error-prone.\"),mdx(\"h2\",{\"id\":\"-possible-solution\",\"style\":{\"position\":\"relative\"}},\"\\uD83D\\uDCA1 Possible Solution\",mdx(\"a\",{parentName:\"h2\",\"href\":\"#-possible-solution\",\"aria-label\":\" possible solution permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"So, I was thinking, what if, similarly to QR-code detection, we will try to \\\"teach\\\" the smartphone to \",mdx(\"em\",{parentName:\"p\"},\"(1)\"),\" \",mdx(\"em\",{parentName:\"p\"},\"detect\"),\" and \",mdx(\"em\",{parentName:\"p\"},\"(2)\"),\" \",mdx(\"em\",{parentName:\"p\"},\"recognize\"),\" printed links for us and to make them \",mdx(\"em\",{parentName:\"p\"},\"clickable\"),\"? This way you would do just one click instead of multiple keystrokes. The operational complexity of \\\"clicking\\\" the printed links goes from \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"O(N)\"),\" to \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"O(1)\"),\".\"),mdx(\"p\",null,\"This is how the final workflow will look like:\"),mdx(\"p\",null,mdx(\"img\",{parentName:\"p\",\"src\":\"/posts-assets/2dc300f4cc152c8b14200c25eba77a02/1.gif\",\"alt\":\"Links Detector Demo\"})),mdx(\"h2\",{\"id\":\"-solution-requirements\",\"style\":{\"position\":\"relative\"}},\"\\uD83D\\uDCDD Solution Requirements\",mdx(\"a\",{parentName:\"h2\",\"href\":\"#-solution-requirements\",\"aria-label\":\" solution requirements permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"As I've mentioned earlier I'm just studying Machine Learning as a hobby. Thus, the purpose of this article is more about \",mdx(\"em\",{parentName:\"p\"},\"learning\"),\" how to work with TensorFlow 2 Object Detection API rather than coming up with a production-ready application.\"),mdx(\"p\",null,\"With that being said, I simplified the solution requirements to the following:\"),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},\"The detection and recognition processes should have a \",mdx(\"strong\",{parentName:\"li\"},\"close-to-real-time\"),\" performance (i.e. \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"0.5-1\"),\" frames per second) on a device like iPhone X. It means that the whole \",mdx(\"em\",{parentName:\"li\"},\"detection + recognition\"),\" process should take up to \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"2\"),\" seconds (pretty bearable as for the amateur project).\"),mdx(\"li\",{parentName:\"ol\"},\"Only \",mdx(\"strong\",{parentName:\"li\"},\"English\"),\" links should be supported.\"),mdx(\"li\",{parentName:\"ol\"},\"Only \",mdx(\"strong\",{parentName:\"li\"},\"dark text\"),\" (i.e. black or dark-grey) on \",mdx(\"strong\",{parentName:\"li\"},\"light background\"),\" (i.e. white or light-grey) should be supported.\"),mdx(\"li\",{parentName:\"ol\"},\"Only \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"https://\"),\" links should be supported for now (it is ok if our model will not recognize the \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"http://\"),\", \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"ftp://\"),\", \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"tcp://\"),\" or other types of links).\")),mdx(\"h2\",{\"id\":\"üß©-solution-breakdown\",\"style\":{\"position\":\"relative\"}},\"\\uD83E\\uDDE9 Solution Breakdown\",mdx(\"a\",{parentName:\"h2\",\"href\":\"#%F0%9F%A7%A9-solution-breakdown\",\"aria-label\":\"üß© solution breakdown permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"h3\",{\"id\":\"high-level-breakdown\",\"style\":{\"position\":\"relative\"}},\"High-level breakdown\",mdx(\"a\",{parentName:\"h3\",\"href\":\"#high-level-breakdown\",\"aria-label\":\"high level breakdown permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"Let's see how we could approach the problem on a high level.\"),mdx(\"h4\",{\"id\":\"option-1-detection-model-on-the-back-end\",\"style\":{\"position\":\"relative\"}},\"Option 1: Detection model on the back-end\",mdx(\"a\",{parentName:\"h4\",\"href\":\"#option-1-detection-model-on-the-back-end\",\"aria-label\":\"option 1 detection model on the back end permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"The flow:\")),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},\"Get camera stream (frame by frame) on the client-side.\"),mdx(\"li\",{parentName:\"ol\"},\"Send each frame one by one over the network to the back-end.\"),mdx(\"li\",{parentName:\"ol\"},\"Do link detection and recognition on the back-end and send the response back to the client.\"),mdx(\"li\",{parentName:\"ol\"},\"Client draws the detection boxes with the clickable links.\")),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"1000px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"76.4%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAgABBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe4zg4x//8QAFxAAAwEAAAAAAAAAAAAAAAAAEBEhQv/aAAgBAQABBQLQVQ//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAEBAQAAAAAAAAAAAAAAAAAQETH/2gAIAQEABj8C1r//xAAaEAADAQADAAAAAAAAAAAAAAAAARExQWFx/9oACAEBAAE/IY12cFRo6QVH6JOaf//aAAwDAQACAAMAAAAQsw//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAEAAwEBAQAAAAAAAAAAAAABABEhMUFh/9oACAEBAAE/EAFWloyWyjGCARseM1TnldlwNeiishyGT5P/2Q==')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Model on the back-end\",\"title\":\"Model on the back-end\",\"src\":\"/static/b1008fc4187f646645a88963ab5d842e/a2510/2.jpg\",\"srcSet\":[\"/static/b1008fc4187f646645a88963ab5d842e/0479a/2.jpg 250w\",\"/static/b1008fc4187f646645a88963ab5d842e/41099/2.jpg 500w\",\"/static/b1008fc4187f646645a88963ab5d842e/a2510/2.jpg 1000w\"],\"sizes\":\"(max-width: 1000px) 100vw, 1000px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"Pros:\")),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC9A The detection performance is not limited by the client's device. We may speed the detection up by scaling the service horizontally (adding more instances) and vertically (adding more cores/GPUs).\"),mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC9A The model might be bigger since there is no need to upload it to the client-side. Downloading the \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"~10Mb\"),\" model on the client-side may be ok, but loading the \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"~100Mb\"),\" model might be a big issue for the client's network and application UX (user experience) otherwise.\"),mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC9A It is possible to control who is using the model. Model is guarded behind the API, so we would have complete control over its callers/clients.\")),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"Cons:\")),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC94 System complexity growth. The application tech stack grew from just \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"JavaScript\"),\" to, let's say, \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"JavaScript + Python\"),\". We need to take care of the autoscaling.\"),mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC94 Offline mode for the app is not possible since it needs an internet connection to work.\"),mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC94 Too many HTTP requests between the client and the server may become a bottleneck at some point. Imagine if we would want to improve the performance of the detection, let's say, from \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"1\"),\" to \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"10+\"),\" frames per second. This means that each client will send \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"10+\"),\" requests per second. For \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"10\"),\" simultaneous clients it is already \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"100+\"),\" requests per second. The \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"HTTP/2\"),\" bidirectional streaming and \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"gRPC\"),\" might be useful in this case, but we're going back to the increased system complexity here.\"),mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC94 System becomes more expensive. Almost all points from the Pros section need to be paid for.\")),mdx(\"h4\",{\"id\":\"option-2-detection-model-on-the-front-end\",\"style\":{\"position\":\"relative\"}},\"Option 2: Detection model on the front-end\",mdx(\"a\",{parentName:\"h4\",\"href\":\"#option-2-detection-model-on-the-front-end\",\"aria-label\":\"option 2 detection model on the front end permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"The flow:\")),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},\"Get camera stream (frame by frame) on the client-side.\"),mdx(\"li\",{parentName:\"ol\"},\"Do link detection and recognition on the client-side (without sending anything to the back-end).\"),mdx(\"li\",{parentName:\"ol\"},\"Client draws the detection boxes with the clickable links.\")),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"1000px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"104.4%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAVABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB7ldc41FRULA//8QAGhAAAgIDAAAAAAAAAAAAAAAAARAAEQISIv/aAAgBAQABBQLKC9kD0qX/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/Ah//xAAZEAEBAQADAAAAAAAAAAAAAAABERAAITH/2gAIAQEAAT8haHXH6WallNTbn//aAAwDAQACAAMAAAAQ7Ah8/8QAFREBAQAAAAAAAAAAAAAAAAAAEAH/2gAIAQMBAT8QIf/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EABkQAQEAAwEAAAAAAAAAAAAAAAERECFBAP/aAAgBAQABPxALvV560Oh3KkQVJ2GdbUXH/9k=')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Model on the front-end\",\"title\":\"Model on the front-end\",\"src\":\"/static/9d35d51a8edae4727238f9dc487ab5e1/a2510/3.jpg\",\"srcSet\":[\"/static/9d35d51a8edae4727238f9dc487ab5e1/0479a/3.jpg 250w\",\"/static/9d35d51a8edae4727238f9dc487ab5e1/41099/3.jpg 500w\",\"/static/9d35d51a8edae4727238f9dc487ab5e1/a2510/3.jpg 1000w\"],\"sizes\":\"(max-width: 1000px) 100vw, 1000px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"Pros:\")),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC9A System is less complex. We don't need to set up the servers, build the API, and introduce an additional Python stack to the system.\"),mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC9A Offline mode is possible. The app doesn't need an internet connection to work since the model is fully loaded to the device. So the Progressive Web Application (\",mdx(\"a\",{parentName:\"li\",\"href\":\"https://web.dev/progressive-web-apps/\"},\"PWA\"),\") might be built to support that.\"),mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC9A System is \\\"kind of\\\" scaling automatically. The more clients you have, the more cores and GPUs they bring. This is not a proper scaling solution though (more about that in a Cons section below).\"),mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC9A System is cheaper. We only need a server for static assets (\",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"HTML\"),\", \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"JS\"),\", \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"CSS\"),\", model files, etc.). This may be done for free, let's say, on GitHub.\"),mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC9A No issue with the growing number of HTTP requests per second to the server-side.\")),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"Cons:\")),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC94 Only horizontal scaling is possible (each client will have its own CPU/GPU). Vertical scaling is not possible since we can't influence the client's device performance. As a result, we can't guarantee fast detection for low performant devices.\"),mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC94 It is not possible to guard the model usage and control the callers/clients of the model. Everyone could download the model and re-use it.\"),mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC94 Battery consumption of the client's device might become an issue. For the model to work it needs computational resources. So clients might not be happy with their iPhone getting warmer and warmer while the app is working.\")),mdx(\"h4\",{\"id\":\"high-level-conclusion\",\"style\":{\"position\":\"relative\"}},\"High-level conclusion\",mdx(\"a\",{parentName:\"h4\",\"href\":\"#high-level-conclusion\",\"aria-label\":\"high level conclusion permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"Since the purpose of the project was more about learning and not coming up with a production-ready solution \",mdx(\"em\",{parentName:\"p\"},\"I decided to go with the second option of serving the model from the client side\"),\". This made the whole project much cheaper (actually with GitHub it was free to host it), and I could focus more on Machine Learning than on the autoscaling back-end infrastructure.\"),mdx(\"h3\",{\"id\":\"lower-level-breakdown\",\"style\":{\"position\":\"relative\"}},\"Lower level breakdown\",mdx(\"a\",{parentName:\"h3\",\"href\":\"#lower-level-breakdown\",\"aria-label\":\"lower level breakdown permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"Ok, so we've decided to go with the serverless solution. Now we have an image from the camera stream as an input that looks something like this:\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"1000px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"100%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBP/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHrmbGmAgUL/8QAGRAAAwADAAAAAAAAAAAAAAAAAAERECAh/9oACAEBAAEFAsd1rKz/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/Ah//xAAdEAACAQQDAAAAAAAAAAAAAAAAAREhMVFhEJHw/9oACAEBAAE/IZeSXlnlS/HQqK7NxsP/2gAMAwEAAgADAAAAEMTXfP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB0QAQEBAAICAwAAAAAAAAAAAAERACFhMXFBkdH/2gAIAQEAAT8QasU95q4nfChQZfjcj2dal5r3qBPsyDw/MyT+N//Z')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Printed Links Input\",\"title\":\"Printed Links Input\",\"src\":\"/static/ad6a433499d46bf50b63d69734154c37/a2510/4.jpg\",\"srcSet\":[\"/static/ad6a433499d46bf50b63d69734154c37/0479a/4.jpg 250w\",\"/static/ad6a433499d46bf50b63d69734154c37/41099/4.jpg 500w\",\"/static/ad6a433499d46bf50b63d69734154c37/a2510/4.jpg 1000w\"],\"sizes\":\"(max-width: 1000px) 100vw, 1000px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,\"We need to solve two sub-tasks for this image:\"),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},\"Links \",mdx(\"strong\",{parentName:\"li\"},\"detection\"),\" (finding the position and bounding boxes of the links)\"),mdx(\"li\",{parentName:\"ol\"},\"Links \",mdx(\"strong\",{parentName:\"li\"},\"recognition\"),\" (recognizing the text of the links)\")),mdx(\"h4\",{\"id\":\"option-1-tesseract-based-solution\",\"style\":{\"position\":\"relative\"}},\"Option 1: Tesseract based solution\",mdx(\"a\",{parentName:\"h4\",\"href\":\"#option-1-tesseract-based-solution\",\"aria-label\":\"option 1 tesseract based solution permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"The first and the most obvious approach would be to solve the \",mdx(\"em\",{parentName:\"p\"},\"Optical Character Recognition\"),\" (\",mdx(\"a\",{parentName:\"p\",\"href\":\"https://en.wikipedia.org/wiki/Optical_character_recognition\"},\"OCR\"),\") task by recognizing the whole text of the image by using, let's say, \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/naptha/tesseract.js\"},\"Tesseract.js\"),\" library. It returns the bounding boxes of the paragraphs, text lines, and text blocks along with the recognized text.\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"1000px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"99.6%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBP/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHryNltAnQoH//EABkQAAIDAQAAAAAAAAAAAAAAAAAhARESIP/aAAgBAQABBQJjHzqSz//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABQQAQAAAAAAAAAAAAAAAAAAADD/2gAIAQEABj8CH//EABoQAAIDAQEAAAAAAAAAAAAAAAABETFREIH/2gAIAQEAAT8hnTJ0z2X1NpWxSWSP/9oADAMBAAIAAwAAABAA2EH/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAeEAEBAQABBAMAAAAAAAAAAAABEQBBITFhkVFx0f/aAAgBAQABPxBsyF+c2bgJ/WrSWXjVHyYbez9upj3ZKOHTec9G/9k=')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Recognized text with bounding boxes\",\"title\":\"Recognized text with bounding boxes\",\"src\":\"/static/a2b20844e61c8aff72a78bd9777f23ce/a2510/5.jpg\",\"srcSet\":[\"/static/a2b20844e61c8aff72a78bd9777f23ce/0479a/5.jpg 250w\",\"/static/a2b20844e61c8aff72a78bd9777f23ce/41099/5.jpg 500w\",\"/static/a2b20844e61c8aff72a78bd9777f23ce/a2510/5.jpg 1000w\"],\"sizes\":\"(max-width: 1000px) 100vw, 1000px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,\"We may try then to extract the links from the recognized text lines or text blocks with a regular expression like \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://stackoverflow.com/questions/3809401/what-is-a-good-regular-expression-to-match-a-url\"},\"this one\"),\" (example is on TypeScript):\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"typescript\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-typescript\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-typescript\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"const\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token constant\"},\"URL_REG_EXP\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token regex\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token regex-delimiter\"},\"/\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token regex-source language-regex\"},\"https?:\\\\/\\\\/(www\\\\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\\\\.[a-z]{2,4}\\\\b([-a-zA-Z0-9@:%_+.~#?&/=]*)\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token regex-delimiter\"},\"/\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token regex-flags\"},\"gi\")),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\";\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"const\"),\" extractLinkFromText \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"text\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\":\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"string\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\":\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"string\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"|\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"null\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=>\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"{\"),\"\\n  \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"const\"),\" urls\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\":\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"string\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"|\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"null\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" text\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"match\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token constant\"},\"URL_REG_EXP\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\";\"),\"\\n  \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"if\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"!\"),\"urls \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"||\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"!\"),\"urls\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"length\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"{\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"null\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\";\"),\"\\n  \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"}\"),\"\\n  \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" urls\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\";\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"}\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\";\")))),mdx(\"p\",null,\"\\uD83D\\uDC9A Seems like the issue is solved in a pretty straightforward and simple way:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"We know the bounding boxes of the links\"),mdx(\"li\",{parentName:\"ul\"},\"We also know the text of the links to make them clickable\")),mdx(\"p\",null,\"\\uD83D\\uDC94 The thing is that the \",mdx(\"em\",{parentName:\"p\"},\"recognition + detection\"),\" time may vary from \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"2\"),\" to \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"20+\"),\" seconds depending on the size of the text, on the amount of \\\"something that looks like a text\\\" on the image, on the image quality and on other factors. So it will be really hard to achieve those \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"0.5-1\"),\" frames per second to make the user experience at least \",mdx(\"em\",{parentName:\"p\"},\"close\"),\" to real-time.\"),mdx(\"p\",null,\"\\uD83D\\uDC94 Also if we would think about it, we're asking the library to recognize the \",mdx(\"strong\",{parentName:\"p\"},\"whole\"),\" text from the image for us even though it might contain only one or two links in it (i.e. only ~10% of the text might be useful for us), or it may even not contain the links at all. In this case, it sounds like a waste of computational resources.\"),mdx(\"h4\",{\"id\":\"option-2-tesseract--tensorflow-based-solution\",\"style\":{\"position\":\"relative\"}},\"Option 2: Tesseract + TensorFlow based solution\",mdx(\"a\",{parentName:\"h4\",\"href\":\"#option-2-tesseract--tensorflow-based-solution\",\"aria-label\":\"option 2 tesseract  tensorflow based solution permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"We could make Tesseract work faster if we used some \",mdx(\"em\",{parentName:\"p\"},\"additional \\\"adviser\\\" algorithm\"),\" prior to the links text recognition. This \\\"adviser\\\" algorithm should detect, but not recognize, \",mdx(\"em\",{parentName:\"p\"},\"the leftmost position\"),\" of each link on the image if there are any. This will allow us to speed up the recognition part by following these rules:\"),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},\"If the image does not contain any link we should not call Tesseract detection/recognition at all.\"),mdx(\"li\",{parentName:\"ol\"},\"If the image does have the links then we need to ask Tesseract to recognize only those parts of the image that contains the links. We're not interested in spending the time for recognition of the irrelevant text that does not contain the links.\")),mdx(\"p\",null,\"The \\\"adviser\\\" algorithm that will take place before the Tesseract should work with a constant time regardless of the image quality, or the presence/absence of the text on the image. It also should be pretty fast and detect the leftmost positions of the links for less than \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"1s\"),\" so that we could satisfy the \\\"close-to-real-time\\\" requirement (i.e. on iPhone X).\"),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},\"\\uD83D\\uDCA1 So what if we will use another object detection model to help us find all occurrences of the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"https://\"),\" substrings (every secure link has this prefix, doesn't it) in the image? Then, having these \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"https://\"),\" bounding boxes in the text we may extract the right-side continuation of them and send them to the Tesseract for text recognition.\")),mdx(\"p\",null,\"Take a look at the picture below:\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"1000px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"55.99999999999999%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHYschDD//EABkQAAEFAAAAAAAAAAAAAAAAAAEAERIgIv/aAAgBAQABBQLUi6FP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFRABAQAAAAAAAAAAAAAAAAAAIEH/2gAIAQEABj8Cq//EABkQAAIDAQAAAAAAAAAAAAAAABARACExgf/aAAgBAQABPyHiYM3Ef//aAAwDAQACAAMAAAAQfM//xAAVEQEBAAAAAAAAAAAAAAAAAAAQMf/aAAgBAwEBPxCH/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAR/9oACAECAQE/EF2f/8QAHBABAAICAwEAAAAAAAAAAAAAAQARITEQQVFx/9oACAEBAAE/EF0PxtVceGEe6yRKsrvuIVv32GuP/9k=')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Tesseract and TensorFlow based solution\",\"title\":\"Tesseract and TensorFlow based solution\",\"src\":\"/static/6ef7e472afd39bfe0d1b7508449d6144/a2510/6.jpg\",\"srcSet\":[\"/static/6ef7e472afd39bfe0d1b7508449d6144/0479a/6.jpg 250w\",\"/static/6ef7e472afd39bfe0d1b7508449d6144/41099/6.jpg 500w\",\"/static/6ef7e472afd39bfe0d1b7508449d6144/a2510/6.jpg 1000w\"],\"sizes\":\"(max-width: 1000px) 100vw, 1000px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,\"You may notice that Tesseract needs to do \",mdx(\"strong\",{parentName:\"p\"},\"much less\"),\" work in case if it would have some hints about where are the links might be located (see the number of blue boxes on both pictures).\"),mdx(\"p\",null,\"So the question now is which object detection model we should choose and how to re-train it to support the detection of the custom \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"https://\"),\" objects.\"),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},\"Finally! We've got closer to the TensorFlow part of the article \\uD83D\\uDE00\")),mdx(\"h2\",{\"id\":\"-selecting-the-object-detection-model\",\"style\":{\"position\":\"relative\"}},\"\\uD83E\\uDD16 Selecting the Object Detection Model\",mdx(\"a\",{parentName:\"h2\",\"href\":\"#-selecting-the-object-detection-model\",\"aria-label\":\" selecting the object detection model permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"Training a new object detection model is not a reasonable option in our context because of the following reasons:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC94 The training process might take days/weeks and bucks.\"),mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC94 We most probably won't be able to collect hundreds of thousands of \",mdx(\"em\",{parentName:\"li\"},\"labeled\"),\" images of the books that have links in them (we might try to generate them though, but more about that later).\")),mdx(\"p\",null,\"So instead of creating a new model, we should better teach an existing object detection model to do the custom object detection for us (to do the \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://en.wikipedia.org/wiki/Transfer_learning\"},\"transfer learning\"),\"). In our case, the \\\"custom objects\\\" would be the images with \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"https://\"),\" text drawn in them. This approach has the following benefits:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC9A The dataset might be much smaller. We don't need to collect hundreds of thousands of the labeled images. Instead, we may do \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"~100\"),\" pictures and label them manually. This is because the model is already pre-trained on the general dataset like \",mdx(\"a\",{parentName:\"li\",\"href\":\"https://cocodataset.org/#home\"},\"COCO dataset\"),\" and already learned how to extract general image features.\"),mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC9A The training process will be much faster (minutes/hours on GPU instead of days/weeks). Again, this is because of a smaller dataset (smaller batches) and because of fewer trainable parameters.\")),mdx(\"p\",null,\"We may choose the existing model from \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2_detection_zoo.md\"},\"TensorFlow 2 Detection Model Zoo\"),\" which provides a collection of detection models pre-trained on the \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://cocodataset.org/#home\"},\"COCO 2017 dataset\"),\". Now it contains \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"~40\"),\" model variations to choose from.\"),mdx(\"p\",null,\"To re-train and fine-tune the model on the custom dataset we will use a \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/tensorflow/models/tree/master/research/object_detection\"},\"TensorFlow 2 Object Detection API\"),\". The TensorFlow Object Detection API is an open-source framework built on top of \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://www.tensorflow.org/\"},\"TensorFlow\"),\" that makes it easy to construct, train, and deploy object detection models.\"),mdx(\"p\",null,\"If you follow the \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2_detection_zoo.md\"},\"Model Zoo\"),\" link you will find the \",mdx(\"em\",{parentName:\"p\"},\"detection speed\"),\" and \",mdx(\"em\",{parentName:\"p\"},\"accuracy\"),\" for each model.\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"1000px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"96.80000000000001%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAABAP/aAAwDAQACEAMQAAAB9uzUFTz2JQP/xAAXEAEBAQEAAAAAAAAAAAAAAAAAAREg/9oACAEBAAEFAmInMf/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABQQAQAAAAAAAAAAAAAAAAAAADD/2gAIAQEABj8CH//EABoQAQEAAgMAAAAAAAAAAAAAAAEAIUEQETH/2gAIAQEAAT8h7zIcpw9TFuba/9oADAMBAAIAAwAAABA8B0D/xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPxAhP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EGM//8QAHBABAAICAwEAAAAAAAAAAAAAAQAxESFxkbGB/9oACAEBAAE/EMmzpjWAutxOHlludy3XsJh0WwU+pbr2U5M//9k=')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Model Zoo\",\"title\":\"Model Zoo\",\"src\":\"/static/f01df6492b87597aa9333c853eaa333b/a2510/7.jpg\",\"srcSet\":[\"/static/f01df6492b87597aa9333c853eaa333b/0479a/7.jpg 250w\",\"/static/f01df6492b87597aa9333c853eaa333b/41099/7.jpg 500w\",\"/static/f01df6492b87597aa9333c853eaa333b/a2510/7.jpg 1000w\"],\"sizes\":\"(max-width: 1000px) 100vw, 1000px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,mdx(\"em\",{parentName:\"p\"},\"Image source: \",mdx(\"a\",{parentName:\"em\",\"href\":\"https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2_detection_zoo.md\"},\"TensorFlow Model Zoo\"),\" repository\")),mdx(\"p\",null,\"Of course, we would want to find the right balance between the detection \",mdx(\"strong\",{parentName:\"p\"},\"speed\"),\" and \",mdx(\"strong\",{parentName:\"p\"},\"accuracy\"),\" while picking the model. But what might be even more important in our case is the \",mdx(\"strong\",{parentName:\"p\"},\"size\"),\" of the model since it will be loaded to the client-side.\"),mdx(\"p\",null,\"The size of the archived model might vary drastically from \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"~20Mb\"),\" to \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"~1Gb\"),\". Here are several examples:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"1386 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"centernet_hg104_1024x1024_kpts_coco17_tpu-32\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 330 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"centernet_resnet101_v1_fpn_512x512_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 195 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"centernet_resnet50_v1_fpn_512x512_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 198 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"centernet_resnet50_v1_fpn_512x512_kpts_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 227 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"centernet_resnet50_v2_512x512_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 230 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"centernet_resnet50_v2_512x512_kpts_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"  29 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"efficientdet_d0_coco17_tpu-32\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"  49 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"efficientdet_d1_coco17_tpu-32\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"  60 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"efficientdet_d2_coco17_tpu-32\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"  89 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"efficientdet_d3_coco17_tpu-32\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 151 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"efficientdet_d4_coco17_tpu-32\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 244 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"efficientdet_d5_coco17_tpu-32\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 376 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"efficientdet_d6_coco17_tpu-32\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 376 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"efficientdet_d7_coco17_tpu-32\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 665 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"extremenet\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 427 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"faster_rcnn_inception_resnet_v2_1024x1024_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 424 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"faster_rcnn_inception_resnet_v2_640x640_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 337 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"faster_rcnn_resnet101_v1_1024x1024_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 337 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"faster_rcnn_resnet101_v1_640x640_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 343 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"faster_rcnn_resnet101_v1_800x1333_coco17_gpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 449 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"faster_rcnn_resnet152_v1_1024x1024_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 449 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"faster_rcnn_resnet152_v1_640x640_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 454 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"faster_rcnn_resnet152_v1_800x1333_coco17_gpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 202 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"faster_rcnn_resnet50_v1_1024x1024_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 202 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"faster_rcnn_resnet50_v1_640x640_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 207 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"faster_rcnn_resnet50_v1_800x1333_coco17_gpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 462 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"mask_rcnn_inception_resnet_v2_1024x1024_coco17_gpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"  86 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"ssd_mobilenet_v1_fpn_640x640_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"  44 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"ssd_mobilenet_v2_320x320_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"  20 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"ssd_mobilenet_v2_fpnlite_320x320_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"  20 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 369 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"ssd_resnet101_v1_fpn_1024x1024_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 369 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"ssd_resnet101_v1_fpn_640x640_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 481 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"ssd_resnet152_v1_fpn_1024x1024_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 480 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"ssd_resnet152_v1_fpn_640x640_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 233 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"ssd_resnet50_v1_fpn_1024x1024_coco17_tpu-8\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\" 233 (Mb)\"),\" \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"ssd_resnet50_v1_fpn_640x640_coco17_tpu-8\"))),mdx(\"p\",null,\"The \",mdx(\"strong\",{parentName:\"p\"},mdx(\"code\",{parentName:\"strong\",\"className\":\"language-text\"},\"ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8\")),\" model might be a good fit in our case:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC9A It is relatively lightweight: \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"20Mb\"),\" archived.\"),mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC9A It is pretty fast: \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"39ms\"),\" for the detection.\"),mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC9A It uses the MobileNet v2 network as a feature extractor which is optimized for usage on mobile devices to reduce energy consumption.\"),mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC9A It does the object detection for the whole image and for all objects in it \",mdx(\"strong\",{parentName:\"li\"},\"in one go\"),\" regardless of the image content (no \",mdx(\"a\",{parentName:\"li\",\"href\":\"https://en.wikipedia.org/wiki/Region_Based_Convolutional_Neural_Networks\"},\"regions proposal\"),\" step is involved which makes the detection faster).\"),mdx(\"li\",{parentName:\"ul\"},\"\\uD83D\\uDC94 It is not the most accurate model though (everything is a tradeoff \\u2696\\uFE0F).\")),mdx(\"p\",null,\"The model name encodes some several important characteristics that you may read more about if you want:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"The expected image input size is \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"640x640px\"),\".\"),mdx(\"li\",{parentName:\"ul\"},\"The model implements \",mdx(\"a\",{parentName:\"li\",\"href\":\"https://arxiv.org/abs/1512.02325\"},\"Single Shot MultiBox Detector\"),\" (SSD) and \",mdx(\"a\",{parentName:\"li\",\"href\":\"https://arxiv.org/abs/1612.03144\"},\"Feature Pyramid Network\"),\" (FPN).\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"href\":\"https://ai.googleblog.com/2018/04/mobilenetv2-next-generation-of-on.html\"},\"MobileNet v2\"),\" convolutional neural network (\",mdx(\"a\",{parentName:\"li\",\"href\":\"https://en.wikipedia.org/wiki/Convolutional_neural_network\"},\"CNN\"),\") is used as a feature extractor.\"),mdx(\"li\",{parentName:\"ul\"},\"The model was trained on \",mdx(\"a\",{parentName:\"li\",\"href\":\"https://cocodataset.org/#home\"},\"COCO dataset\"))),mdx(\"h2\",{\"id\":\"-installing-object-detection-api\",\"style\":{\"position\":\"relative\"}},\"\\uD83D\\uDEE0 Installing Object Detection API\",mdx(\"a\",{parentName:\"h2\",\"href\":\"#-installing-object-detection-api\",\"aria-label\":\" installing object detection api permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"In this article, we're going to install the Tensorflow 2 Object Detection API \",mdx(\"em\",{parentName:\"p\"},\"as a Python package\"),\". It is convenient in case if you're experimenting in \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://colab.research.google.com/\"},\"Google Colab\"),\" (recommended) or in \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://jupyter.org/try\"},\"Jupyter\"),\". For both cases no local installation is needed, you may experiment right in your browser.\"),mdx(\"p\",null,\"You may also follow the \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2.md\"},\"official documentation\"),\" if you would prefer to install Object Detection API via Docker.\"),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},\"If you stuck with something during the API installation or during the dataset preparation try to read through the \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://tensorflow-object-detection-api-tutorial.readthedocs.io/en/latest/index.html\"},\"TensorFlow 2 Object Detection API tutorial\"),\" which adds a lot of useful details to this process.\")),mdx(\"p\",null,\"First, let's clone the \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/tensorflow/models\"},\"API repository\"),\":\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"bash\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-bash\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-bash\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"git\"),\" clone --depth \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1\"),\" https://github.com/tensorflow/models\"))),mdx(\"p\",null,mdx(\"em\",{parentName:\"p\"},\"output \\u2192\")),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"Cloning into 'models'...\\nremote: Enumerating objects: 2301, done.\\nremote: Counting objects: 100% (2301/2301), done.\\nremote: Compressing objects: 100% (2000/2000), done.\\nremote: Total 2301 (delta 561), reused 922 (delta 278), pack-reused 0\\nReceiving objects: 100% (2301/2301), 30.60 MiB | 13.90 MiB/s, done.\\nResolving deltas: 100% (561/561), done.\"))),mdx(\"p\",null,\"Now, let's compile the \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/tensorflow/models/tree/master/research/object_detection/protos\"},\"API proto files\"),\" into Python files by using \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://grpc.io/docs/protoc-installation/\"},\"protoc\"),\" tool:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"bash\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-bash\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-bash\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin class-name\"},\"cd\"),\" ./models/research\\nprotoc object_detection/protos/*.proto --python_out\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\".\"))),mdx(\"p\",null,\"Finally, let's install the TF2 version of \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/tensorflow/models/blob/master/research/object_detection/packages/tf2/setup.py\"},\"setup.py\"),\" via \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"pip\"),\":\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"bash\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-bash\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-bash\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"cp\"),\" ./object_detection/packages/tf2/setup.py \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin class-name\"},\".\"),\"\\npip \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"install\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin class-name\"},\".\"),\" --quiet\"))),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},\"It is possible that the last step will fail because of some dependency errors. In this case, you might want to run \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"pip install . --quiet\"),\" one more time.\")),mdx(\"p\",null,\"We may test that installation went successfully by running the following tests:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"bash\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-bash\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-bash\"},\"python object_detection/builders/model_builder_tf2_test.py\"))),mdx(\"p\",null,\"You should see the logs that end with something similar to this:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"[       OK ] ModelBuilderTF2Test.test_unknown_ssd_feature_extractor\\n----------------------------------------------------------------------\\nRan 20 tests in 45.072s\\n\\nOK (skipped=1)\"))),mdx(\"p\",null,\"The TensorFlow Object Detection API is installed! You may now use the scripts that API provides for doing the model \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/tensorflow/models/blob/master/research/object_detection/colab_tutorials/inference_tf2_colab.ipynb\"},\"inference\"),\", \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2_training_and_evaluation.md\"},\"training\"),\" or \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/tensorflow/models/blob/master/research/object_detection/colab_tutorials/eager_few_shot_od_training_tf2_colab.ipynb\"},\"fine-tuning\"),\".\"),mdx(\"h2\",{\"id\":\"Ô∏è-downloading-the-pre-trained-model\",\"style\":{\"position\":\"relative\"}},\"\\u2B07\\uFE0F Downloading the Pre-Trained Model\",mdx(\"a\",{parentName:\"h2\",\"href\":\"#%EF%B8%8F-downloading-the-pre-trained-model\",\"aria-label\":\"Ô∏è downloading the pre trained model permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"Let's download our selected \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8\"),\" model from the TensorFlow Model Zoo and check how it does the general object detection (detection of the objects of classes from COCO dataset like \\\"cat\\\", \\\"dog\\\", \\\"car\\\", etc.).\"),mdx(\"p\",null,\"We will use the \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://www.tensorflow.org/api_docs/python/tf/keras/utils/get_file\"},\"get_file()\"),\" TensorFlow helper to download the archived model from the URL and unpack it.\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" tensorflow \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" tf\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" pathlib\\n\\nMODEL_NAME \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8'\"),\"\\nTF_MODELS_BASE_PATH \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'http://download.tensorflow.org/models/object_detection/tf2/20200711/'\"),\"\\nCACHE_FOLDER \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'./cache'\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"download_tf_model\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"model_name\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" cache_folder\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    model_url \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" TF_MODELS_BASE_PATH \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"+\"),\" model_name \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"+\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'.tar.gz'\"),\"\\n    model_dir \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"keras\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"utils\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"get_file\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n        fname\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"model_name\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        origin\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"model_url\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        untar\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"True\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        cache_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"pathlib\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"cache_folder\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"absolute\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" model_dir\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Start the model download.\"),\"\\nmodel_dir \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" download_tf_model\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"MODEL_NAME\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" CACHE_FOLDER\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"model_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"p\",null,mdx(\"em\",{parentName:\"p\"},\"output \\u2192\")),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"/content/cache/datasets/ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8\"))),mdx(\"p\",null,\"Here is how the folder structure looks so far:\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"972px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"80%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAgAF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB22EKo//EABcQAAMBAAAAAAAAAAAAAAAAAAECECH/2gAIAQEAAQUCOVr/AP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABwQAQACAgMBAAAAAAAAAAAAAAERIQAQMUGR8f/aAAgBAQABPyGTrhwV+aswW4T3Pmv/2gAMAwEAAgADAAAAEKPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBABAAIDAAMAAAAAAAAAAAAAAQARMUFRYXGR/9oACAEBAAE/EFZV6HswCfU9xBDRlNeIwFrcwg2bn//Z')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Cache Folder\",\"title\":\"Cache Folder\",\"src\":\"/static/ba6e6aef4124664efef1f1af4f1f9c95/95c6e/8.jpg\",\"srcSet\":[\"/static/ba6e6aef4124664efef1f1af4f1f9c95/0479a/8.jpg 250w\",\"/static/ba6e6aef4124664efef1f1af4f1f9c95/41099/8.jpg 500w\",\"/static/ba6e6aef4124664efef1f1af4f1f9c95/95c6e/8.jpg 972w\"],\"sizes\":\"(max-width: 972px) 100vw, 972px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,\"The \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"checkpoint\"),\" folder contains the snapshot of the pre-trained model.\"),mdx(\"p\",null,\"The \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"pipeline.config\"),\" file contains the detection settings of the model. We'll come back to this file later when we will need to fine-tune the model.\"),mdx(\"h2\",{\"id\":\"Ô∏è-trying-the-model-doing-the-inference\",\"style\":{\"position\":\"relative\"}},\"\\uD83C\\uDFC4\\uD83C\\uDFFB\\u200D\\uFE0F Trying the Model (Doing the Inference)\",mdx(\"a\",{parentName:\"h2\",\"href\":\"#%EF%B8%8F-trying-the-model-doing-the-inference\",\"aria-label\":\"Ô∏è trying the model doing the inference permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"For now, the model can detect the object of \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://cocodataset.org/#explore\"},\"90 COCO dataset classes\"),\" like a \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"car\"),\", \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"bird\"),\", \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"hot dog\"),\" etc.\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"1000px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"22.799999999999997%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB06Cwf//EABkQAAMAAwAAAAAAAAAAAAAAAAABAhESE//aAAgBAQABBQKo1FGXyP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABgQAAIDAAAAAAAAAAAAAAAAAAARASGB/9oACAEBAAY/AmzCpP/EABgQAQEBAQEAAAAAAAAAAAAAAAERADFB/9oACAEBAAE/IZoS3AAr60HQ3//aAAwDAQACAAMAAAAQ8A//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEAAgIDAAAAAAAAAAAAAAABABEhQTFR4f/aAAgBAQABPxA7za2vBS17KktOLuYQJvdvc//Z')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"COCO classes\",\"title\":\"COCO classes\",\"src\":\"/static/43edaafc7d30b56f3421efff4cac6d42/a2510/9.jpg\",\"srcSet\":[\"/static/43edaafc7d30b56f3421efff4cac6d42/0479a/9.jpg 250w\",\"/static/43edaafc7d30b56f3421efff4cac6d42/41099/9.jpg 500w\",\"/static/43edaafc7d30b56f3421efff4cac6d42/a2510/9.jpg 1000w\",\"/static/43edaafc7d30b56f3421efff4cac6d42/c58a3/9.jpg 1500w\",\"/static/43edaafc7d30b56f3421efff4cac6d42/d14d4/9.jpg 1562w\"],\"sizes\":\"(max-width: 1000px) 100vw, 1000px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,mdx(\"em\",{parentName:\"p\"},\"Image source: \",mdx(\"a\",{parentName:\"em\",\"href\":\"https://cocodataset.org/#explore\"},\"COCO dataset\"),\" website\")),mdx(\"p\",null,\"Let's see how the model performs on some general images that contain the objects of these classes.\"),mdx(\"h3\",{\"id\":\"loading-coco-labels\",\"style\":{\"position\":\"relative\"}},\"Loading COCO labels\",mdx(\"a\",{parentName:\"h3\",\"href\":\"#loading-coco-labels\",\"aria-label\":\"loading coco labels permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"Object Detection API already has a complete set of COCO labels (classes) defined for us.\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" os\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Import Object Detection API helpers.\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" object_detection\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"utils \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" label_map_util\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Loads the COCO labels data (class names and indices relations).\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"load_coco_labels\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Object Detection API already has a complete set of COCO classes defined for us.\"),\"\\n    label_map_path \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"join\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'models/research/object_detection/data'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'mscoco_complete_label_map.pbtxt'\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    label_map \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" label_map_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"load_labelmap\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"label_map_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Class ID to Class Name mapping.\"),\"\\n    categories \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" label_map_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"convert_label_map_to_categories\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n        label_map\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        max_num_classes\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"label_map_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"get_max_label_map_index\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"label_map\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        use_display_name\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"True\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    category_index \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" label_map_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"create_category_index\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"categories\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Class Name to Class ID mapping.\"),\"\\n    label_map_dict \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" label_map_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"get_label_map_dict\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"label_map\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" use_display_name\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"True\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" category_index\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" label_map_dict\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Load COCO labels.\"),\"\\ncoco_category_index\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" coco_label_map_dict \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" load_coco_labels\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'coco_category_index:'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" coco_category_index\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'coco_label_map_dict:'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" coco_label_map_dict\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"p\",null,mdx(\"em\",{parentName:\"p\"},\"output \\u2192\")),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"coco_category_index:\\n{\\n    1: {'id': 1, 'name': 'person'},\\n    2: {'id': 2, 'name': 'bicycle'},\\n    ...\\n    90: {'id': 90, 'name': 'toothbrush'},\\n}\\n\\ncoco_label_map_dict:\\n{\\n    'background': 0,\\n    'person': 1,\\n    'bicycle': 2,\\n    'car': 3,\\n    ...\\n    'toothbrush': 90,\\n}\"))),mdx(\"h3\",{\"id\":\"build-a-detection-function\",\"style\":{\"position\":\"relative\"}},\"Build a detection function\",mdx(\"a\",{parentName:\"h3\",\"href\":\"#build-a-detection-function\",\"aria-label\":\"build a detection function permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"We need to create a detection function that will use the pre-trained model we've downloaded to do the object detection.\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" tensorflow \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" tf\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Import Object Detection API helpers.\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" object_detection\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"utils \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" config_util\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" object_detection\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"builders \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" model_builder\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Generates the detection function for specific model and specific model's checkpoint\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"detection_fn_from_checkpoint\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"config_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" checkpoint_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Build the model.\"),\"\\n    pipeline_config \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" config_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"get_configs_from_pipeline_file\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"config_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    model_config \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" pipeline_config\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'model'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n    model \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" model_builder\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"build\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n        model_config\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"model_config\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        is_training\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"False\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Restore checkpoints.\"),\"\\n    ckpt \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"compat\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"v2\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"train\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Checkpoint\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"model\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"model\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    ckpt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"restore\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"checkpoint_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"expect_partial\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# This is a function that will do the detection.\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token decorator annotation punctuation\"},\"@tf\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\".\"),\"function\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"detect_fn\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" shapes \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" model\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"preprocess\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        prediction_dict \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" model\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"predict\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" shapes\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        detections \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" model\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"postprocess\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"prediction_dict\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" shapes\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" prediction_dict\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"reshape\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"shapes\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"-\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" detect_fn\\n\\ninference_detect_fn \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" detection_fn_from_checkpoint\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n    config_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"join\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'cache'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'datasets'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" MODEL_NAME\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'pipeline.config'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    checkpoint_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"join\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'cache'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'datasets'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" MODEL_NAME\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'checkpoint'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'ckpt-0'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"p\",null,\"This \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"inference_detect_fn\"),\" function will accept an image and will return the detected objects' info.\"),mdx(\"h3\",{\"id\":\"loading-the-images-for-inference\",\"style\":{\"position\":\"relative\"}},\"Loading the images for inference\",mdx(\"a\",{parentName:\"h3\",\"href\":\"#loading-the-images-for-inference\",\"aria-label\":\"loading the images for inference permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"Let's try to detect the object on this image:\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"640px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"100%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQDAv/EABcBAQEBAQAAAAAAAAAAAAAAAAECAAP/2gAMAwEAAhADEAAAAc9eNQ7Ts0zFFAjr/8QAHRAAAgIBBQAAAAAAAAAAAAAAAQIAEhETFCEiMf/aAAgBAQABBQICajLNw8VWzTueSPLFnoJ//8QAGBEAAgMAAAAAAAAAAAAAAAAAAAEQETH/2gAIAQMBAT8BKFsf/8QAFREBAQAAAAAAAAAAAAAAAAAAEiD/2gAIAQIBAT8BMf/EAB0QAQABAwUAAAAAAAAAAAAAAAEAEBFBAiExQlH/2gAIAQEABj8Cd0ljWzEPJfrmqPFP/8QAHRABAAMAAQUAAAAAAAAAAAAAAQARITEQUWFx0f/aAAgBAQABPyEUt4gXCjiHFQr+JSM744EwcnJRGukObDhPdP/aAAwDAQACAAMAAAAQlNdA/8QAFhEBAQEAAAAAAAAAAAAAAAAAEQAQ/9oACAEDAQE/EHQX/8QAGBEBAAMBAAAAAAAAAAAAAAAAAAERMVH/2gAIAQIBAT8QKnqcW//EAB4QAAICAgIDAAAAAAAAAAAAAAERADEhQVFxYYGx/9oACAEBAAE/EBcmOCQLuMy7x/OoSDDbuo7DvFnMxjCNJ6txg2JI8QXmTfMpccNCEuw6M//Z')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"General Object Inference\",\"title\":\"General Object Inference\",\"src\":\"/static/9e7ca505789722a51d11eeede2b2d3c3/c08c5/10.jpg\",\"srcSet\":[\"/static/9e7ca505789722a51d11eeede2b2d3c3/0479a/10.jpg 250w\",\"/static/9e7ca505789722a51d11eeede2b2d3c3/41099/10.jpg 500w\",\"/static/9e7ca505789722a51d11eeede2b2d3c3/c08c5/10.jpg 640w\"],\"sizes\":\"(max-width: 640px) 100vw, 640px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,mdx(\"em\",{parentName:\"p\"},\"Image source: \",mdx(\"a\",{parentName:\"em\",\"href\":\"https://www.instagram.com/oleksii_trekhleb/?hl=en\"},\"oleksii_trekhleb\"),\" Instagram\")),mdx(\"p\",null,\"To do that let's save the image to the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"inference/test/\"),\" folder of our project. If you're using Google Colab you may create this folder and upload the image manually.\"),mdx(\"p\",null,\"Here is how the folder structure looks so far:\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"602px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"61.6%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe3uUoP/xAAZEAACAwEAAAAAAAAAAAAAAAAQEQABAjH/2gAIAQEAAQUC5p0FEP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABoQAQACAwEAAAAAAAAAAAAAAAEAEBEhYVH/2gAIAQEAAT8hV4M7U5O1mHlf/9oADAMBAAIAAwAAABAzz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAQEAAgIDAAAAAAAAAAAAAAERACEQMVFhgf/aAAgBAQABPxBNXbTx1iBZ+bwaCk9YN0A0NQ1gaIBOP//Z')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Folder structure\",\"title\":\"Folder structure\",\"src\":\"/static/17fdcc432317dd5e59a939360936b0b0/e49d1/11.jpg\",\"srcSet\":[\"/static/17fdcc432317dd5e59a939360936b0b0/0479a/11.jpg 250w\",\"/static/17fdcc432317dd5e59a939360936b0b0/41099/11.jpg 500w\",\"/static/17fdcc432317dd5e59a939360936b0b0/e49d1/11.jpg 602w\"],\"sizes\":\"(max-width: 602px) 100vw, 602px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" matplotlib\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"pyplot \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" plt\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"%\"),\"matplotlib inline\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Creating a TensorFlow dataset of just one image.\"),\"\\ninference_ds \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"keras\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"preprocessing\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"image_dataset_from_directory\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n  directory\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'inference'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n  image_size\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"640\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"640\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n  batch_size\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n  shuffle\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"False\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n  label_mode\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"None\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Numpy version of the dataset.\"),\"\\ninference_ds_numpy \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"list\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"inference_ds\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"as_numpy_iterator\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# You may preview the images in dataset like this.\"),\"\\nplt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"figure\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"figsize\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"14\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"14\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"for\"),\" i\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" image \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"in\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"enumerate\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"inference_ds_numpy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    plt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"subplot\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"2\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"2\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" i \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"+\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    plt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"imshow\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"astype\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"\\\"uint8\\\"\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    plt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"axis\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"\\\"off\\\"\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\nplt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"show\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"h3\",{\"id\":\"running-the-detection-on-test-data\",\"style\":{\"position\":\"relative\"}},\"Running the detection on test data\",mdx(\"a\",{parentName:\"h3\",\"href\":\"#running-the-detection-on-test-data\",\"aria-label\":\"running the detection on test data permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"Now we're ready to run the detection. The \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"inference_ds_numpy[0]\"),\" array stores the pixel data for the first image in \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"Numpy\"),\" format.\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},\"detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" predictions_dict\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" shapes \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" inference_detect_fn\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n    inference_ds_numpy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"p\",null,\"Let's see the shapes of the output:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},\"boxes \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'detection_boxes'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"numpy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\nscores \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'detection_scores'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"numpy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\nclasses \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'detection_classes'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"numpy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\nnum_detections \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'num_detections'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"numpy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'boxes.shape: '\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" boxes\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"shape\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'scores.shape: '\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" scores\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"shape\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'classes.shape: '\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" classes\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"shape\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'num_detections:'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" num_detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"p\",null,mdx(\"em\",{parentName:\"p\"},\"output \\u2192\")),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"boxes.shape:  (1, 100, 4)\\nscores.shape:  (1, 100)\\nclasses.shape:  (1, 100)\\nnum_detections: 100.0\"))),mdx(\"p\",null,\"The model has made a \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"100\"),\" detections for us. It doesn't mean that it found \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"100\"),\" objects on the image though. It means that the model has \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"100\"),\" slots, and it can detect \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"100\"),\" objects at max on a single image. Each detection has a score that represents the confidence of the model about it. The bounding boxes for each detection are stored in the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"boxes\"),\" array. The scores or confidences of the model about each detection are stored in the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"scores\"),\" array. Finally, the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"classes\"),\" array stores the labels (classes) for each detection.\"),mdx(\"p\",null,\"Let's check the first 5 detections:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'First 5 boxes:'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"boxes\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"5\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'First 5 scores:'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"scores\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"5\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'First 5 classes:'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"classes\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"5\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\nclass_names \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),\"coco_category_index\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),\"idx \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"+\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'name'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"for\"),\" idx \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"in\"),\" classes\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'First 5 class names:'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"class_names\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"5\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"p\",null,mdx(\"em\",{parentName:\"p\"},\"output \\u2192\")),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"First 5 boxes:\\n[[0.17576033 0.84654826 0.25642633 0.88327974]\\n [0.5187813  0.12410264 0.6344235  0.34545377]\\n [0.5220358  0.5181462  0.6329132  0.7669856 ]\\n [0.50933677 0.7045719  0.5619138  0.7446198 ]\\n [0.44761637 0.51942706 0.61237675 0.75963426]]\\n\\nFirst 5 scores:\\n[0.6950246 0.6343004 0.591157  0.5827219 0.5415643]\\n\\nFirst 5 classes:\\n[9. 8. 8. 0. 8.]\\n\\nFirst 5 class names:\\n['traffic light', 'boat', 'boat', 'person', 'boat']\"))),mdx(\"p\",null,\"The model sees the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"traffic light\"),\", three \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"boats\"),\", and a \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"person\"),\" on the image. We may confirm that indeed these objects are seen on the image.\"),mdx(\"p\",null,\"From the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"scores\"),\" array may see that the model is most confident (close to 70% of probability) in the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"traffic light\"),\" object.\"),mdx(\"p\",null,\"Each entry of \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"boxes\"),\" array is \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"[y1, x1, y2, x2]\"),\", where \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"(x1, y1)\"),\" and \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"(x2, y2)\"),\" are the top-left and bottom-right corners of the bounding box.\"),mdx(\"p\",null,\"Let's visualize the detection boxes:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Importing Object Detection API helpers.\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" object_detection\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"utils \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" visualization_utils\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Visualizes the bounding boxes on top of the image.\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"visualize_detections\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image_np\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" category_index\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    label_id_offset \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1\"),\"\\n    image_np_with_detections \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" image_np\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"copy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    visualization_utils\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"visualize_boxes_and_labels_on_image_array\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n        image_np_with_detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'detection_boxes'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"numpy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'detection_classes'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"numpy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"+\"),\" label_id_offset\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"astype\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"int\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'detection_scores'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"numpy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        category_index\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        use_normalized_coordinates\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"True\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        max_boxes_to_draw\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"200\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        min_score_thresh\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\".4\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        agnostic_mode\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"False\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    plt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"figure\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"figsize\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"12\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"16\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    plt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"imshow\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image_np_with_detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    plt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"show\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Visualizing the detections.\"),\"\\nvisualize_detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n    image_np\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"cast\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"inference_ds_numpy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" dtype\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"uint32\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"numpy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    category_index\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"coco_category_index\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"p\",null,\"Here is the output:\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"709px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"99.2%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGQABAAIDAAAAAAAAAAAAAAAAAAECAwQF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQID/9oADAMBAAIQAxAAAAGU3klrl6eISwnT/8QAHBAAAQQDAQAAAAAAAAAAAAAAAgABEhMRFCEz/9oACAEBAAEFAi9LCBbBohKyPX68GzDL0iv/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8BI//EABURAQEAAAAAAAAAAAAAAAAAABEg/9oACAECAQE/ASP/xAAdEAACAQQDAAAAAAAAAAAAAAAAAQIRITFBECJR/9oACAEBAAY/Ap9mrlFNmh+VE1ZLPDMs2f/EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQVGR4f/aAAgBAQABPyHfZnGwEKUcJM+PSYNLO44A7SURqN3brErdXjqX/U//2gAMAwEAAgADAAAAEHwA/P/EABYRAQEBAAAAAAAAAAAAAAAAABABMf/aAAgBAwEBPxATT//EABkRAQACAwAAAAAAAAAAAAAAAAABETFRYf/aAAgBAgEBPxDlU7Thb//EAB4QAQADAAICAwAAAAAAAAAAAAEAESExQVFhcZHR/9oACAEBAAE/ECjQiAELfFdZLp8aW98QYXdW7/YpyplHS/mCFCbLPrtj7DbOMj2Wqu+4ftOFyleqjqYf/9k=')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Inference result\",\"title\":\"Inference result\",\"src\":\"/static/9312de3c7465a05f9ddd12eca3d9d385/bd958/12.jpg\",\"srcSet\":[\"/static/9312de3c7465a05f9ddd12eca3d9d385/0479a/12.jpg 250w\",\"/static/9312de3c7465a05f9ddd12eca3d9d385/41099/12.jpg 500w\",\"/static/9312de3c7465a05f9ddd12eca3d9d385/bd958/12.jpg 709w\"],\"sizes\":\"(max-width: 709px) 100vw, 709px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,\"If we will do the detection for the text image here is what we will see:\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"709px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"99.2%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBP/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHujMikDqkNB//EABwQAAICAgMAAAAAAAAAAAAAAAABAhIDERAhMv/aAAgBAQABBQKTdts7JeuHjW6FD//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABcQAAMBAAAAAAAAAAAAAAAAAAABMRD/2gAIAQEABj8CevXSsrP/xAAcEAACAgIDAAAAAAAAAAAAAAAAAREhEHExYZH/2gAIAQEAAT8hobfJ2M3fpJ7y8MOmzGiCAf/aAAwDAQACAAMAAAAQLBDD/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAIBABAAICAQQDAAAAAAAAAAAAAQARIUFxYYGR0aGxwf/aAAgBAQABPxAgCLbY3v3sXfsRiYpcxzKGnHSN3n5lcZRwm3iKY856jd+56n//2Q==')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Inference result for text image\",\"title\":\"Inference result for text image\",\"src\":\"/static/372fe51fcd25300ff07e0bba1d94b846/bd958/13.jpg\",\"srcSet\":[\"/static/372fe51fcd25300ff07e0bba1d94b846/0479a/13.jpg 250w\",\"/static/372fe51fcd25300ff07e0bba1d94b846/41099/13.jpg 500w\",\"/static/372fe51fcd25300ff07e0bba1d94b846/bd958/13.jpg 709w\"],\"sizes\":\"(max-width: 709px) 100vw, 709px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,\"The model couldn't detect anything on this image. This is what we're going to change, we want to teach the model to \\\"see\\\" the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"https://\"),\" prefixes on this image.\"),mdx(\"h2\",{\"id\":\"-preparing-the-custom-dataset\",\"style\":{\"position\":\"relative\"}},\"\\uD83D\\uDCDD Preparing the Custom Dataset\",mdx(\"a\",{parentName:\"h2\",\"href\":\"#-preparing-the-custom-dataset\",\"aria-label\":\" preparing the custom dataset permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"To \\\"teach\\\" the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8\"),\" model to detect the custom objects which are \",mdx(\"em\",{parentName:\"p\"},\"not\"),\" a part of a COCO dataset we need to do the fine-tune training on a new custom dataset.\"),mdx(\"p\",null,\"The datasets for object detection consist of two parts:\"),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},\"The image itself (i.e. the image of the book page)\"),mdx(\"li\",{parentName:\"ol\"},\"The boundary boxes that show where exactly on the image the custom objects are located.\")),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"1000px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"52.400000000000006%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3VoB/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGRAAAgMBAAAAAAAAAAAAAAAAAAERIFFh/9oACAEBAAE/IXpPRU//2gAMAwEAAgADAAAAEHDP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAAIDAQAAAAAAAAAAAAAAAQARECExcf/aAAgBAQABPxCw7NXyptVdRWdHyAQMf//Z')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Bounding Boxes\",\"title\":\"Bounding Boxes\",\"src\":\"/static/be25b47e961629a02f8ed3a656535b42/a2510/14.jpg\",\"srcSet\":[\"/static/be25b47e961629a02f8ed3a656535b42/0479a/14.jpg 250w\",\"/static/be25b47e961629a02f8ed3a656535b42/41099/14.jpg 500w\",\"/static/be25b47e961629a02f8ed3a656535b42/a2510/14.jpg 1000w\"],\"sizes\":\"(max-width: 1000px) 100vw, 1000px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,\"In the example above each box has \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"left-top\"),\" and \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"right-bottom\"),\" coordinates in \",mdx(\"em\",{parentName:\"p\"},\"absolute\"),\" values (in pixels). However, there are also different formats of writing the location of the bounding boxes exists. For example, we may locate the bounding box by setting the coordinate of its \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"center point\"),\" and its \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"width\"),\" and \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"height\"),\". We might also use \",mdx(\"em\",{parentName:\"p\"},\"relative\"),\" values (percentage of the width and height of the image) for setting up the coordinates. But you've got the idea, the network needs to know what the image is and where on the image the objects are located.\"),mdx(\"p\",null,\"Now, how can we get the custom dataset for training? We have three options here:\"),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},mdx(\"em\",{parentName:\"li\"},\"Re-use\"),\" the existing dataset.\"),mdx(\"li\",{parentName:\"ol\"},mdx(\"em\",{parentName:\"li\"},\"Generate\"),\" a new dataset of fake book images.\"),mdx(\"li\",{parentName:\"ol\"},mdx(\"em\",{parentName:\"li\"},\"Create\"),\" the dataset manually by taking or downloading the pictures of real book pages which contain \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"https://\"),\" links and labeling all bounding boxes.\")),mdx(\"h3\",{\"id\":\"option-1-re-using-the-existing-dataset\",\"style\":{\"position\":\"relative\"}},\"Option 1: Re-using the existing dataset\",mdx(\"a\",{parentName:\"h3\",\"href\":\"#option-1-re-using-the-existing-dataset\",\"aria-label\":\"option 1 re using the existing dataset permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"There are plenty of the datasets that are shared to be re-used by researches. We could start from the following resources to find a proper dataset:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"href\":\"https://datasetsearch.research.google.com/\"},\"Google Dataset Search\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"href\":\"https://www.kaggle.com/datasets\"},\"Kaggle Datasets\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"href\":\"https://github.com/awesomedata/awesome-public-datasets\"},\"awesome-public-datasets\"),\" repository\"),mdx(\"li\",{parentName:\"ul\"},\"etc.\")),mdx(\"p\",null,\"\\uD83D\\uDC9A If you could find the needed dataset and its license allows you to re-use it, it is probably the fastest way to get straight to the model training.\"),mdx(\"p\",null,\"\\uD83D\\uDC94 I couldn't find the dataset with labeled \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"https://\"),\" prefixes though.\"),mdx(\"p\",null,\"So we need to skip this option.\"),mdx(\"h3\",{\"id\":\"option-2-generating-the-synthetic-dataset\",\"style\":{\"position\":\"relative\"}},\"Option 2: Generating the synthetic dataset\",mdx(\"a\",{parentName:\"h3\",\"href\":\"#option-2-generating-the-synthetic-dataset\",\"aria-label\":\"option 2 generating the synthetic dataset permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"There are tools that exist (i.e. \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://keras-ocr.readthedocs.io/en/latest/examples/end_to_end_training.html#generating-synthetic-data\"},\"keras_ocr\"),\") that might help us to generate random text, include the link in it, and draw it on images with some background and distortions.\"),mdx(\"p\",null,\"\\uD83D\\uDC9A The cool part about this approach is that we have the freedom to generate training examples for different \",mdx(\"em\",{parentName:\"p\"},\"fonts\"),\", \",mdx(\"em\",{parentName:\"p\"},\"ligatures\"),\", \",mdx(\"em\",{parentName:\"p\"},\"text colors\"),\", \",mdx(\"em\",{parentName:\"p\"},\"background colors\"),\". This is very useful if we want to avoid the \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://en.wikipedia.org/wiki/Overfitting\"},\"model overfitting\"),\" during the training (so that the model could generalize well to unseen real-world examples instead of failing once the background shade is changed for a bit).\"),mdx(\"p\",null,\"\\uD83D\\uDC9A It is also possible to generate a variety of link types like \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"http://\"),\", \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"http://\"),\", \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"ftp://\"),\", \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"tcp://\"),\" etc. Otherwise, it might be hard to find enough real-world examples of this kind of links for training.\"),mdx(\"p\",null,\"\\uD83D\\uDC9A Another benefit of this approach is that we could generate as many training examples as we want. We're not limited to the number of pages of the printed book we've found for the dataset. Increasing the number of training examples may also increase the accuracy of the model.\"),mdx(\"p\",null,\"\\uD83D\\uDC94 It is possible though to misuse the generator and to generate the training images that will be quite different from real-world examples. Let's say we may use the wrong and unrealistic distortions for the page (i.e. using waves bend instead of the arc one). In this case, the model will not generalize well to real-world examples.\"),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},\"I see this approach as a really promising one. It may help to overcome many model issues (more on that below). I didn't try it yet though. But it might be a good candidate for another article.\")),mdx(\"h3\",{\"id\":\"option-3-creating-the-dataset-manually\",\"style\":{\"position\":\"relative\"}},\"Option 3: Creating the dataset manually\",mdx(\"a\",{parentName:\"h3\",\"href\":\"#option-3-creating-the-dataset-manually\",\"aria-label\":\"option 3 creating the dataset manually permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"The most straightforward way though is to get the book (or books) and to make the pictures of the pages with the links and to label all of them manually.\"),mdx(\"p\",null,\"The good news is that the dataset might be pretty small (hundreds of images might be enough) because we're not going to train the model \",mdx(\"em\",{parentName:\"p\"},\"from scratch\"),\" but instead, we're going to do a \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://en.wikipedia.org/wiki/Transfer_learning\"},\"transfer learning\"),\" (also see the \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://paperswithcode.com/task/few-shot-learning\"},\"few-shot learning\"),\".)\"),mdx(\"p\",null,\"\\uD83D\\uDC9A In this case, the training dataset will be really close to real-world data. You will literally take the printed book, take a picture of it with realistic fonts, bends, shades, perspectives, and colors.\"),mdx(\"p\",null,\"\\uD83D\\uDC94 Even though it doesn't require a lot of images it may still be time-consuming.\"),mdx(\"p\",null,\"\\uD83D\\uDC94 It is hard to come up with a diverse database where training examples would have different fonts, background colors, and different types of links (we need to find many diverse books and magazines to accomplish that).\"),mdx(\"p\",null,\"Since the article has a learning purpose and since we're not trying to win an object detection competition let's go with this option for now and try to create a dataset by ourselves.\"),mdx(\"h3\",{\"id\":\"preprocessing-the-data\",\"style\":{\"position\":\"relative\"}},\"Preprocessing the data\",mdx(\"a\",{parentName:\"h3\",\"href\":\"#preprocessing-the-data\",\"aria-label\":\"preprocessing the data permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"So, I've ended up shooting \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"125\"),\" images of the book pages that contain one or more \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"https://\"),\" links on them.\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"1000px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"60.4%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAddWgKD/xAAXEAADAQAAAAAAAAAAAAAAAAARIUEA/9oACAEBAAEFApKMEH//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAaEAADAQADAAAAAAAAAAAAAAAAATEhAjJB/9oACAEBAAY/Al29Jyg8ZWVwes//xAAcEAACAgIDAAAAAAAAAAAAAAAAATFREUEhgZH/2gAIAQEAAT8hSUANLKie6KFD2PmqbO4Wf//aAAwDAQACAAMAAAAQAA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAfEAABBAICAwAAAAAAAAAAAAABABEhMUFxUWGBkcH/2gAIAQEAAT8QMgg1jI38XgWgzdb5RA9jeDArpFAxh9nRCLDPa72i41jmoIC//9k=')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Raw Dataset\",\"title\":\"Raw Dataset\",\"src\":\"/static/5ef08870a8d0193042c9da2c8aa8eb0c/a2510/15.jpg\",\"srcSet\":[\"/static/5ef08870a8d0193042c9da2c8aa8eb0c/0479a/15.jpg 250w\",\"/static/5ef08870a8d0193042c9da2c8aa8eb0c/41099/15.jpg 500w\",\"/static/5ef08870a8d0193042c9da2c8aa8eb0c/a2510/15.jpg 1000w\"],\"sizes\":\"(max-width: 1000px) 100vw, 1000px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,\"I put all these images in the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"dataset/printed_links/raw\"),\" folder.\"),mdx(\"p\",null,\"Next, I'm going to preprocess the images by doing the following:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"Resize\"),\" each image to the width of \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"1024px\"),\" (they are too big originally and have a width of \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"3024px\"),\")\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"Crop\"),\" each image to make them squared (this is optional, and we could just resize the image by simply squeezing it, but I want the model to be trained on realistic proportions of \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"https:\"),\" boxes).\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"Rotate\"),\" image if needed by applying the \",mdx(\"a\",{parentName:\"li\",\"href\":\"https://en.wikipedia.org/wiki/Exif\"},\"exif\"),\" metadata.\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"Greyscale\"),\" the image (we don't need the model to take the colors into consideration).\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"Increase brightness\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"Increase contrast\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"Increase sharpness\"))),mdx(\"p\",null,\"Remember, that once we've decided to apply these transformations and adjustments to the dataset we need to do the same in the future for each image that we will send to the model for detection.\"),mdx(\"p\",null,\"Here is how we could apply these adjustments to the image using Python:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" os\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" math\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" shutil\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" pathlib \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" Path\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" PIL \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" ImageOps\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" ImageEnhance\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Resize an image.\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"preprocess_resize\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"target_width\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"preprocess\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\" Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" log\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"-\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\">\"),\" Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"width\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" height\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"size\\n        ratio \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" width \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"/\"),\" height\\n\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"if\"),\" width \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\">\"),\" target_width\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n            target_height \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" math\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"floor\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"target_width \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"/\"),\" ratio\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n            log\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string-interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"f'Resizing: To size \"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"target_width\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"x\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"target_height\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"'\")),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n            image \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"resize\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"target_width\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" target_height\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"else\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n            log\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'Resizing: Image already resized, skipping...'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" image\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" preprocess\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Crop an image.\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"preprocess_crop_square\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"preprocess\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\" Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" log\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"-\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\">\"),\" Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"width\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" height\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"size\\n\\n        left \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),\"\\n        top \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),\"\\n        right \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" width\\n        bottom \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" height\\n\\n        crop_size \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"min\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"width\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" height\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"if\"),\" width \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\">=\"),\" height\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n            \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Horizontal image.\"),\"\\n            log\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string-interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"f'Squre cropping: Horizontal \"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"crop_size\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"x\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"crop_size\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"'\")),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n            left \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" width \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"//\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"2\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"-\"),\" crop_size \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"//\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"2\"),\"\\n            right \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" left \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"+\"),\" crop_size\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"else\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n            \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Vetyical image.\"),\"\\n            log\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string-interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"f'Squre cropping: Vertical \"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"crop_size\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"x\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"crop_size\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"'\")),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n            top \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" height \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"//\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"2\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"-\"),\" crop_size \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"//\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"2\"),\"\\n            bottom \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" top \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"+\"),\" crop_size\\n\\n        image \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"crop\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"left\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" top\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" right\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" bottom\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" image\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" preprocess\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Apply exif transpose to an image.\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"preprocess_exif_transpose\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# @see: https://pillow.readthedocs.io/en/stable/reference/ImageOps.html\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"preprocess\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\" Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" log\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"-\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\">\"),\" Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        log\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'EXif transpose'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        image \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" ImageOps\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"exif_transpose\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" image\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" preprocess\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Apply color transformations to the image.\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"preprocess_color\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"brightness\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" contrast\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" color\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" sharpness\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# @see: https://pillow.readthedocs.io/en/3.0.x/reference/ImageEnhance.html\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"preprocess\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\" Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" log\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"-\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\">\"),\" Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        log\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'Coloring'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        enhancer \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" ImageEnhance\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Color\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        image \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" enhancer\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"enhance\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"color\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        enhancer \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" ImageEnhance\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Brightness\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        image \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" enhancer\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"enhance\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"brightness\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        enhancer \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" ImageEnhance\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Contrast\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        image \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" enhancer\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"enhance\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"contrast\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        enhancer \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" ImageEnhance\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Sharpness\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        image \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" enhancer\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"enhance\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"sharpness\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" image\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" preprocess\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Image pre-processing pipeline.\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"preprocess_pipeline\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"src_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" dest_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" preprocessors\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" files_num_limit\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" override\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"False\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Create destination folder if not exists.\"),\"\\n    Path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"dest_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"mkdir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"parents\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"False\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" exist_ok\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"True\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Get the list of files to be copied.\"),\"\\n    src_file_names \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"listdir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"src_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    files_total \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" files_num_limit \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"if\"),\" files_num_limit \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\">\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"else\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"len\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"src_file_names\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    files_processed \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Logger function.\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"preprocessor_log\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"message\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'  '\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"+\"),\" message\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Iterate through files.\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"for\"),\" src_file_index\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" src_file_name \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"in\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"enumerate\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"src_file_names\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"if\"),\" files_num_limit \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\">\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"and\"),\" src_file_index \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\">=\"),\" files_num_limit\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n            \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"break\"),\"\\n\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Copy file.\"),\"\\n        src_file_path \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"join\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"src_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" src_file_name\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        dest_file_path \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"join\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"dest_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" src_file_name\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        progress \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" math\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"floor\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"100\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"*\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"src_file_index \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"+\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"/\"),\" files_total\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string-interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"f'Image \"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"src_file_index \",mdx(\"span\",{parentName:\"span\",\"className\":\"token operator\"},\"+\"),\" \",mdx(\"span\",{parentName:\"span\",\"className\":\"token number\"},\"1\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"/\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"files_total\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\" | \"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"progress\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"% |  \"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"src_file_path\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"'\")),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"if\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"not\"),\" os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"isfile\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"src_file_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n            preprocessor_log\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'Source is not a file, skipping...\\\\n'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n            \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"continue\"),\"\\n\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"if\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"not\"),\" override \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"and\"),\" os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"exists\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"dest_file_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n            preprocessor_log\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'File already exists, skipping...\\\\n'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n            \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"continue\"),\"\\n\\n        shutil\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"copy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"src_file_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" dest_file_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        files_processed \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"+=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1\"),\"\\n\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Preprocess file.\"),\"\\n        image \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"open\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"dest_file_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"for\"),\" preprocessor \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"in\"),\" preprocessors\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n            image \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" preprocessor\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" preprocessor_log\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"save\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"dest_file_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" quality\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"95\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"''\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string-interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"f'\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"files_processed\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\" out of \"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"files_total\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\" files have been processed'\")),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Launching the image preprocessing pipeline.\"),\"\\npreprocess_pipeline\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n    src_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/raw'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    dest_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/processed'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    override\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"True\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# files_num_limit=1,\"),\"\\n    preprocessors\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),\"\\n        preprocess_exif_transpose\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        preprocess_resize\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"target_width\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1024\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        preprocess_crop_square\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        preprocess_color\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"brightness\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"2\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" contrast\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1.3\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" color\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" sharpness\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"p\",null,\"As a result, all processed images were saved to the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"dataset/printed_links/processed\"),\" folder.\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"1000px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"52%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3KBR/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABPyFf/9oADAMBAAIAAwAAABCzD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAQABBQADAAAAAAAAAAAAAAEAESExQVFhscH/2gAIAQEAAT8QwY13zEPe4BVr3soUxr7EL27AKtp//9k=')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Dataset Processed\",\"title\":\"Dataset Processed\",\"src\":\"/static/d573633530a534c4c87aeb4d0bc0f2d6/a2510/16.jpg\",\"srcSet\":[\"/static/d573633530a534c4c87aeb4d0bc0f2d6/0479a/16.jpg 250w\",\"/static/d573633530a534c4c87aeb4d0bc0f2d6/41099/16.jpg 500w\",\"/static/d573633530a534c4c87aeb4d0bc0f2d6/a2510/16.jpg 1000w\"],\"sizes\":\"(max-width: 1000px) 100vw, 1000px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,\"You may preview the images like this:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" matplotlib\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"pyplot \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" plt\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" numpy \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" np\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"preview_images\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"images_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" images_num\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" figsize\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"15\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"15\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    image_names \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"listdir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"images_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    image_names \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" image_names\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"images_num\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n\\n    num_cells \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" math\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"ceil\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"math\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"sqrt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"images_num\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    figure \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" plt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"figure\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"figsize\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"figsize\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"for\"),\" image_index\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" image_name \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"in\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"enumerate\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image_names\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        image_path \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"join\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"images_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" image_name\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        image \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"open\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        figure\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"add_subplot\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"num_cells\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" num_cells\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" image_index \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"+\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        plt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"imshow\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"np\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"asarray\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    plt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"show\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\npreview_images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/processed'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" images_num\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"4\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" figsize\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"16\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"16\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"h3\",{\"id\":\"labeling-the-dataset\",\"style\":{\"position\":\"relative\"}},\"Labeling the dataset\",mdx(\"a\",{parentName:\"h3\",\"href\":\"#labeling-the-dataset\",\"aria-label\":\"labeling the dataset permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"To do the labeling (to mark the locations of the objects that we're interested in, namely the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"https://\"),\" prefixes) we may use the \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/tzutalin/labelImg\"},\"LabelImg\"),\" graphical image annotation tool.\"),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},\"For this step you might want to install the LabelImg tool on your local machine (not in Colab). You may find the detailed installation instructions in \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/tzutalin/labelImg\"},\"LabelImg README\"),\".\")),mdx(\"p\",null,\"Once you have LabelImg tool installed you may launch it for the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"dataset/printed_links/processed\"),\" folder from the root of your project like this:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"bash\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-bash\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-bash\"},\"labelImg dataset/printed_links/processed\"))),mdx(\"p\",null,\"Then you'll need to label all the images from the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"dataset/printed_links/processed\"),\" folder and save annotations as XML files to \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"dataset/printed_links/labels/xml/\"),\" folder.\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"1000px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"49.199999999999996%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAde0hkB//8QAGBAAAgMAAAAAAAAAAAAAAAAAABABITH/2gAIAQEAAQUCVEYv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFhAAAwAAAAAAAAAAAAAAAAAAECAx/9oACAEBAAY/AhU//8QAGxAAAQQDAAAAAAAAAAAAAAAAAQARIDEhkfD/2gAIAQEAAT8hBpPixpctA//aAAwDAQACAAMAAAAQgw//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAADAQEBAQAAAAAAAAAAAAAAAREhkUFR/9oACAEBAAE/EMof29NQ1dQTj0UVuaMrP//Z')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Labeling\",\"title\":\"Labeling\",\"src\":\"/static/84c3f7d93cf84fce45d6093732c6ef01/a2510/17.jpg\",\"srcSet\":[\"/static/84c3f7d93cf84fce45d6093732c6ef01/0479a/17.jpg 250w\",\"/static/84c3f7d93cf84fce45d6093732c6ef01/41099/17.jpg 500w\",\"/static/84c3f7d93cf84fce45d6093732c6ef01/a2510/17.jpg 1000w\"],\"sizes\":\"(max-width: 1000px) 100vw, 1000px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,mdx(\"img\",{parentName:\"p\",\"src\":\"/posts-assets/1a60a56a4a04291057f8b04ae1d6aed2/18.gif\",\"alt\":\"Labeling Process\"})),mdx(\"p\",null,\"After the labeling we should have an XML file with bounding boxes data for each image:\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"622px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"86.4%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAARABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAB5hbnIFDIP//EABQQAQAAAAAAAAAAAAAAAAAAADD/2gAIAQEAAQUCH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABQQAQAAAAAAAAAAAAAAAAAAADD/2gAIAQEABj8CH//EABoQAQEAAwEBAAAAAAAAAAAAAAEAETFRECH/2gAIAQEAAT8hLDxsMP2V7Zjc68//2gAMAwEAAgADAAAAEIcfff/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExEJFRYYH/2gAIAQEAAT8QClIxPKXyehiUy9ypt3LeWauT/9k=')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Labels folder structure\",\"title\":\"Labels folder structure\",\"src\":\"/static/bfa1a524d91a647ee2ecfcd419d1be74/5e4ef/19.jpg\",\"srcSet\":[\"/static/bfa1a524d91a647ee2ecfcd419d1be74/0479a/19.jpg 250w\",\"/static/bfa1a524d91a647ee2ecfcd419d1be74/41099/19.jpg 500w\",\"/static/bfa1a524d91a647ee2ecfcd419d1be74/5e4ef/19.jpg 622w\"],\"sizes\":\"(max-width: 622px) 100vw, 622px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"h3\",{\"id\":\"splitting-the-dataset-into-train-test-and-validation-subsets\",\"style\":{\"position\":\"relative\"}},\"Splitting the dataset into train, test, and validation subsets\",mdx(\"a\",{parentName:\"h3\",\"href\":\"#splitting-the-dataset-into-train-test-and-validation-subsets\",\"aria-label\":\"splitting the dataset into train test and validation subsets permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"To identify the model's \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://en.wikipedia.org/wiki/Overfitting\"},\"overfitting or underfitting\"),\" issue we need to split the dataset into \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"train\"),\" and \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"test\"),\" dataset. Let's say \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"80%\"),\" of our images will be used to train the model and \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"20%\"),\" of the images will be used to check how well the model generalizes to the images that it didn't see before.\"),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},\"In this section we'll do the files splitting by copying them into different folders (\",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"test\"),\" and \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"train\"),\" folders). However, this might not be the most optimal way. Instead, the splitting of the dataset may be done on \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://www.tensorflow.org/api_docs/python/tf/data/Dataset\"},\"tf.data.Dataset\"),\" level.\")),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" re\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" random\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"partition_dataset\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n    images_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    xml_labels_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    train_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    test_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    val_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    train_ratio\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    test_ratio\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    val_ratio\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    copy_xml\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"if\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"not\"),\" os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"exists\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"train_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"makedirs\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"train_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"if\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"not\"),\" os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"exists\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"test_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"makedirs\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"test_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"if\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"not\"),\" os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"exists\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"val_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"makedirs\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"val_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    images \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),\"f \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"for\"),\" f \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"in\"),\" os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"listdir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"images_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n              \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"if\"),\" re\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"search\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"r'([a-zA-Z0-9\\\\s_\\\\\\\\.\\\\-\\\\(\\\\):])+(.jpg|.jpeg|.png)$'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" f\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" re\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"IGNORECASE\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n\\n    num_images \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"len\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    num_train_images \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" math\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"ceil\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"train_ratio \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"*\"),\" num_images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    num_test_images \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" math\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"ceil\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"test_ratio \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"*\"),\" num_images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    num_val_images \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" math\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"ceil\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"val_ratio \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"*\"),\" num_images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'Intended split'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string-interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"f'  train: \"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"num_train_images\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"/\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"num_images\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\" images'\")),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string-interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"f'  test: \"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"num_test_images\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"/\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"num_images\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\" images'\")),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string-interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"f'  val: \"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"num_val_images\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"/\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"num_images\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\" images'\")),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    actual_num_train_images \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),\"\\n    actual_num_test_images \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),\"\\n    actual_num_val_images \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"copy_random_images\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"num_images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" dest_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        copied_num \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),\"\\n\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"if\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"not\"),\" num_images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n            \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" copied_num\\n\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"for\"),\" i \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"in\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"range\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"num_images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n            \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"if\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"not\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"len\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n                \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"break\"),\"\\n\\n            idx \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" random\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"randint\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"len\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"-\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n            filename \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),\"idx\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n            shutil\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"copyfile\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"join\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"images_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"join\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"dest_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n            \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"if\"),\" copy_xml\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n                xml_filename \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"splitext\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"+\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'.xml'\"),\"\\n                shutil\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"copyfile\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"join\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"xml_labels_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" xml_filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"join\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"dest_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" xml_filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n            images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"remove\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),\"idx\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n            copied_num \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"+=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1\"),\"\\n\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" copied_num\\n\\n    actual_num_train_images \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" copy_random_images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"num_train_images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" train_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    actual_num_test_images \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" copy_random_images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"num_test_images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" test_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    actual_num_val_images \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" copy_random_images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"num_val_images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" val_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'\\\\n'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'Actual split'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string-interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"f'  train: \"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"actual_num_train_images\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"/\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"num_images\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\" images'\")),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string-interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"f'  test: \"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"actual_num_test_images\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"/\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"num_images\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\" images'\")),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string-interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"f'  val: \"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"actual_num_val_images\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"/\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"num_images\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\" images'\")),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\npartition_dataset\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n    images_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/processed'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    train_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/partitioned/train'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    test_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/partitioned/test'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    val_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/partitioned/val'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    xml_labels_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/labels/xml'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    train_ratio\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0.8\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    test_ratio\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0.2\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    val_ratio\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    copy_xml\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"True\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"p\",null,\"After splitting your dataset folder structure should look similar to this:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"dataset/\\n\\u2514\\u2500\\u2500 printed_links\\n    \\u251C\\u2500\\u2500 labels\\n    \\u2502   \\u2514\\u2500\\u2500 xml\\n    \\u251C\\u2500\\u2500 partitioned\\n    \\u2502   \\u251C\\u2500\\u2500 test\\n    \\u2502   \\u2514\\u2500\\u2500 train\\n    \\u2502       \\u251C\\u2500\\u2500 IMG_9140.JPG\\n    \\u2502       \\u251C\\u2500\\u2500 IMG_9140.xml\\n    \\u2502       \\u251C\\u2500\\u2500 IMG_9141.JPG\\n    \\u2502       \\u251C\\u2500\\u2500 IMG_9141.xml\\n    \\u2502       ...\\n    \\u251C\\u2500\\u2500 processed\\n    \\u2514\\u2500\\u2500 raw\"))),mdx(\"h3\",{\"id\":\"exporting-the-dataset\",\"style\":{\"position\":\"relative\"}},\"Exporting the dataset\",mdx(\"a\",{parentName:\"h3\",\"href\":\"#exporting-the-dataset\",\"aria-label\":\"exporting the dataset permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"The last manipulation we should do with the data is to convert our datasets into \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://www.tensorflow.org/tutorials/load_data/tfrecord\"},\"TFRecord\"),\" format. The \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"TFRecord\"),\" format is a format that TensorFlow is using for storing a sequence of binary records.\"),mdx(\"p\",null,\"First, let's create two folders: one is for the labels in \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"CSV\"),\" format, and the other one is for the final dataset in \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"TFRecord\"),\" format.\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"bash\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-bash\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-bash\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"mkdir\"),\" -p dataset/printed_links/labels/csv\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"mkdir\"),\" -p dataset/printed_links/tfrecords\"))),mdx(\"p\",null,\"Now we need to create a \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"dataset/printed_links/labels/label_map.pbtxt\"),\" proto file that will describe the classes of the objects in our dataset. In our case, we only have \",mdx(\"em\",{parentName:\"p\"},\"one class\"),\" which we may call \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"http\"),\". Here is the content of this file:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"item {\\n  id: 1\\n  name: 'http'\\n}\"))),mdx(\"p\",null,\"Now we're ready to generate the TFRecord datasets out of images in \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"jpg\"),\" format and labels in \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"xml\"),\" format:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" os\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" io\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" math\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" glob\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" tensorflow \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" tf\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" pandas \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" pd\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" xml\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"etree\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"ElementTree \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" ET\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" PIL \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" Image\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" collections \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" namedtuple\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" object_detection\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"utils \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" dataset_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" label_map_util\\n\\ntf1 \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"compat\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"v1\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Convers labels from XML format to CSV.\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"xml_to_csv\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    xml_list \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"for\"),\" xml_file \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"in\"),\" glob\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"glob\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"path \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"+\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'/*.xml'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        tree \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" ET\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"parse\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"xml_file\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        root \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" tree\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"getroot\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"for\"),\" member \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"in\"),\" root\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"findall\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'object'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n            value \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"root\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"find\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'filename'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"text\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n                \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"int\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"root\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"find\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'size'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"text\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n                \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"int\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"root\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"find\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'size'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"text\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n                member\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"text\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n                \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"int\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"member\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"4\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"text\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n                \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"int\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"member\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"4\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"text\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n                \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"int\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"member\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"4\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"2\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"text\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n                \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"int\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"member\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"4\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"3\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"text\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n            \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n            xml_list\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"append\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"value\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    column_name \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'filename'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'width'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'height'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'class'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'xmin'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'ymin'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'xmax'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'ymax'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n    xml_df \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" pd\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"DataFrame\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"xml_list\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" columns\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"column_name\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" xml_df\\n\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"class_text_to_int\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"row_label\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" label_map_dict\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" label_map_dict\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),\"row_label\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"split\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"df\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" group\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    data \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" namedtuple\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'data'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'filename'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'object'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    gb \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" df\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"groupby\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"group\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),\"data\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" gb\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"get_group\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"x\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"for\"),\" filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" x \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"in\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"zip\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"gb\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"groups\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"keys\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" gb\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"groups\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Creates a TFRecord.\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"create_tf_example\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"group\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" label_map_dict\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"with\"),\" tf1\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"gfile\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"GFile\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"join\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'{}'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"format\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"group\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'rb'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" fid\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        encoded_jpg \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" fid\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"read\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    encoded_jpg_io \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" io\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"BytesIO\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"encoded_jpg\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    image \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" Image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"open\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"encoded_jpg_io\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    width\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" height \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"size\\n\\n    filename \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" group\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"encode\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'utf8'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    image_format \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"b'jpg'\"),\"\\n    xmins \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n    xmaxs \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n    ymins \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n    ymaxs \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n    classes_text \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n    classes \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"for\"),\" index\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" row \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"in\"),\" group\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"object\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"iterrows\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        xmins\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"append\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"row\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'xmin'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"/\"),\" width\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        xmaxs\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"append\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"row\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'xmax'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"/\"),\" width\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        ymins\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"append\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"row\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'ymin'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"/\"),\" height\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        ymaxs\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"append\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"row\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'ymax'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"/\"),\" height\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        classes_text\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"append\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"row\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'class'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"encode\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'utf8'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        classes\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"append\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"class_text_to_int\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"row\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'class'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" label_map_dict\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    tf_example \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" tf1\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"train\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Example\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"features\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"tf1\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"train\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Features\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"feature\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"{\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'image/height'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\" dataset_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"int64_feature\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"height\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'image/width'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\" dataset_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"int64_feature\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"width\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'image/filename'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\" dataset_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"bytes_feature\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'image/source_id'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\" dataset_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"bytes_feature\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'image/encoded'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\" dataset_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"bytes_feature\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"encoded_jpg\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'image/format'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\" dataset_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"bytes_feature\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image_format\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'image/object/bbox/xmin'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\" dataset_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"float_list_feature\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"xmins\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'image/object/bbox/xmax'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\" dataset_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"float_list_feature\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"xmaxs\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'image/object/bbox/ymin'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\" dataset_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"float_list_feature\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"ymins\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'image/object/bbox/ymax'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\" dataset_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"float_list_feature\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"ymaxs\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'image/object/class/text'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\" dataset_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"bytes_list_feature\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"classes_text\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'image/object/class/label'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\" dataset_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"int64_list_feature\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"classes\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"}\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" tf_example\\n\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"dataset_to_tfrecord\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n    images_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    xmls_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    label_map_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    output_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    csv_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"None\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    label_map \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" label_map_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"load_labelmap\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"label_map_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    label_map_dict \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" label_map_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"get_label_map_dict\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"label_map\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    tfrecord_writer \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" tf1\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"python_io\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"TFRecordWriter\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"output_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    images_path \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" os\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"join\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"images_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    csv_examples \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" xml_to_csv\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"xmls_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    grouped_examples \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" split\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"csv_examples\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'filename'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"for\"),\" group \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"in\"),\" grouped_examples\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        tf_example \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" create_tf_example\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"group\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" images_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" label_map_dict\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        tfrecord_writer\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"write\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"tf_example\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"SerializeToString\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    tfrecord_writer\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"close\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'Successfully created the TFRecord file: {}'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"format\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"output_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"if\"),\" csv_path \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"is\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"not\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"None\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        csv_examples\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"to_csv\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"csv_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" index\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"None\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'Successfully created the CSV file: {}'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"format\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"csv_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Generate a TFRecord for train dataset.\"),\"\\ndataset_to_tfrecord\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n    images_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/partitioned/train'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    xmls_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/partitioned/train'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    label_map_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/labels/label_map.pbtxt'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    output_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/tfrecords/train.record'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    csv_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/labels/csv/train.csv'\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Generate a TFRecord for test dataset.\"),\"\\ndataset_to_tfrecord\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n    images_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/partitioned/test'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    xmls_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/partitioned/test'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    label_map_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/labels/label_map.pbtxt'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    output_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/tfrecords/test.record'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    csv_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/labels/csv/test.csv'\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"p\",null,\"As a result we should now have two files: \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"test.record\"),\" and \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"train.record\"),\" in \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"dataset/printed_links/tfrecords/\"),\" folder:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"dataset/\\n\\u2514\\u2500\\u2500 printed_links\\n    \\u251C\\u2500\\u2500 labels\\n    \\u2502   \\u251C\\u2500\\u2500 csv\\n    \\u2502   \\u251C\\u2500\\u2500 label_map.pbtxt\\n    \\u2502   \\u2514\\u2500\\u2500 xml\\n    \\u251C\\u2500\\u2500 partitioned\\n    \\u2502   \\u251C\\u2500\\u2500 test\\n    \\u2502   \\u251C\\u2500\\u2500 train\\n    \\u2502   \\u2514\\u2500\\u2500 val\\n    \\u251C\\u2500\\u2500 processed\\n    \\u251C\\u2500\\u2500 raw\\n    \\u2514\\u2500\\u2500 tfrecords\\n        \\u251C\\u2500\\u2500 test.record\\n        \\u2514\\u2500\\u2500 train.record\"))),mdx(\"p\",null,\"These two files \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"test.record\"),\" and \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"train.record\"),\" are our final datasets that we will use to fine-tune the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8\"),\" model.\"),mdx(\"h2\",{\"id\":\"-exploring-the-tfrecord-datasets\",\"style\":{\"position\":\"relative\"}},\"\\uD83D\\uDCD6 Exploring the TFRecord Datasets\",mdx(\"a\",{parentName:\"h2\",\"href\":\"#-exploring-the-tfrecord-datasets\",\"aria-label\":\" exploring the tfrecord datasets permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"In this section, we will see how we may use the TensorFlow 2 Object Detection API to explore the datasets in \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"TFRecord\"),\" format.\"),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"Checking the number of items in a dataset\")),mdx(\"p\",null,\"To count the number of items in the dataset we may do the following:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" tensorflow \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" tf\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Count the number of examples in the dataset.\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"count_tfrecords\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"tfrecords_filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    raw_dataset \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"data\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"TFRecordDataset\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"tfrecords_filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Keep in mind that the list() operation might be\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# a performance bottleneck for large datasets.\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"len\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"list\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"raw_dataset\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\nTRAIN_RECORDS_NUM \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" count_tfrecords\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/tfrecords/train.record'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\nTEST_RECORDS_NUM \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" count_tfrecords\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/tfrecords/test.record'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'TRAIN_RECORDS_NUM: '\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" TRAIN_RECORDS_NUM\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'TEST_RECORDS_NUM:  '\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" TEST_RECORDS_NUM\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"p\",null,mdx(\"em\",{parentName:\"p\"},\"output \\u2192\")),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"TRAIN_RECORDS_NUM:  100\\nTEST_RECORDS_NUM:   25\"))),mdx(\"p\",null,\"So we will train the model on \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"100\"),\" examples, and we will check the model accuracy on \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"25\"),\" test images.\"),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"Previewing the dataset images with bounding boxes\")),mdx(\"p\",null,\"To preview images with detection boxes we may do the following:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" tensorflow \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" tf\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" numpy \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" np\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" google\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"protobuf \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" text_format\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" matplotlib\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"pyplot \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" plt\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Import Object Detection API.\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" object_detection\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"utils \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" visualization_utils\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" object_detection\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"protos \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" string_int_label_map_pb2\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" object_detection\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"data_decoders\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"tf_example_decoder \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" TfExampleDecoder\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"%\"),\"matplotlib inline\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Visualize the TFRecord dataset.\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"visualize_tfrecords\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"tfrecords_filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" label_map\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"None\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" print_num\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    decoder \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" TfExampleDecoder\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n        label_map_proto_file\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"label_map\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        use_display_name\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"False\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"if\"),\" label_map \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"is\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"not\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"None\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        label_map_proto \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" string_int_label_map_pb2\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"StringIntLabelMap\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"with\"),\" tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"io\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"gfile\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"GFile\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"label_map\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'r'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" f\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n            text_format\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Merge\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"f\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"read\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" label_map_proto\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n            class_dict \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"{\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"}\"),\"\\n\\n            \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"for\"),\" entry \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"in\"),\" label_map_proto\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"item\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n                class_dict\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),\"entry\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"id\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"{\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'name'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\" entry\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"name\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"}\"),\"\\n\\n    raw_dataset \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"data\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"TFRecordDataset\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"tfrecords_filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"for\"),\" raw_record \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"in\"),\" raw_dataset\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"take\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"print_num\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        example \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" decoder\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"decode\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"raw_record\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        image \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" example\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'image'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"numpy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        boxes \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" example\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'groundtruth_boxes'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"numpy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        confidences \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" example\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'groundtruth_image_confidences'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n        filename \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" example\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'filename'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n        area \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" example\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'groundtruth_area'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n        classes \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" example\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'groundtruth_classes'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"numpy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        image_classes \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" example\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'groundtruth_image_classes'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n        weights \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" example\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'groundtruth_weights'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n\\n        scores \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" np\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"ones\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"boxes\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"shape\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        visualization_utils\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"visualize_boxes_and_labels_on_image_array\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n            image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n            boxes\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n            classes\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n            scores\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n            class_dict\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n            max_boxes_to_draw\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"None\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n            use_normalized_coordinates\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"True\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        plt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"figure\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"figsize\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"8\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"8\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        plt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"imshow\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    plt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"show\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Visualizing the training TFRecord dataset.\"),\"\\nvisualize_tfrecords\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n    tfrecords_filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/tfrecords/train.record'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    label_map\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/labels/label_map.pbtxt'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    print_num\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"3\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"p\",null,\"As a result, we should see several images with bounding boxes drawn on top of each image.\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"962px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"98%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQADAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHvtdCBiAH/xAAaEAACAgMAAAAAAAAAAAAAAAAAAQIQESEx/9oACAEBAAEFAqRwyRtaP//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABcQAAMBAAAAAAAAAAAAAAAAAAEQcSD/2gAIAQEABj8CRrNx/8QAHBAAAwACAwEAAAAAAAAAAAAAAAERMVEQIXGB/9oACAEBAAE/IVxmFnZ5HpSwa6+GdLZ//9oADAMBAAIAAwAAABBzDwD/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAeEAEAAgEEAwAAAAAAAAAAAAABABEhMUFxsVFhkf/aAAgBAQABPxACaEo8R36V0Rq1qVzzLVdvksPTLoiUFd4OVu6DdBtngn//2Q==')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"TFRecord Preview\",\"title\":\"TFRecord Preview\",\"src\":\"/static/ae63de06652048e7989d778b786dfec0/82d6d/20.jpg\",\"srcSet\":[\"/static/ae63de06652048e7989d778b786dfec0/0479a/20.jpg 250w\",\"/static/ae63de06652048e7989d778b786dfec0/41099/20.jpg 500w\",\"/static/ae63de06652048e7989d778b786dfec0/82d6d/20.jpg 962w\"],\"sizes\":\"(max-width: 962px) 100vw, 962px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"h2\",{\"id\":\"-setting-up-tensorboard\",\"style\":{\"position\":\"relative\"}},\"\\uD83D\\uDCC8 Setting Up TensorBoard\",mdx(\"a\",{parentName:\"h2\",\"href\":\"#-setting-up-tensorboard\",\"aria-label\":\" setting up tensorboard permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"Before starting the training process we need to launch a \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://www.tensorflow.org/tensorboard\"},\"TensorBoard\"),\".\"),mdx(\"p\",null,\"TensorBoard will allow us to monitor the training process and see if the model is actually learning something or should we better stop the training and adjust training parameters. It will also help us to analyze what objects and at what location the model is detecting.\"),mdx(\"p\",null,mdx(\"img\",{parentName:\"p\",\"src\":\"/posts-assets/d5ee9f7aee1b94550125340243d5ccf5/21.gif\",\"alt\":\"TensorBoard\"})),mdx(\"p\",null,mdx(\"em\",{parentName:\"p\"},\"Image source: \",mdx(\"a\",{parentName:\"em\",\"href\":\"https://www.tensorflow.org/tensorboard\"},\"TensorBoard homepage\"))),mdx(\"p\",null,\"The cool part about TensorBoard is that we may run it directly in Google Colab. However, if you're running the notebook in your local installation of Jupyter you may also \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/tensorflow/tensorboard/blob/master/README.md\"},\"install it as Python package\"),\" and launch it from the terminal.\"),mdx(\"p\",null,\"First, let's create a \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"./logs\"),\" folder where all training logs will be written:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"bash\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-bash\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-bash\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"mkdir\"),\" -p logs\"))),mdx(\"p\",null,\"Next, we may load the TensorBoard extension on Google Colab:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"%load_ext tensorboard\"))),mdx(\"p\",null,\"And finally we may launch a TensorBoard to monitor the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"./logs\"),\" folder:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"%tensorboard --logdir ./logs\"))),mdx(\"p\",null,\"As a result, you should see the empty TensorBoard panel:\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"1000px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"54.400000000000006%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEDAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAeyqPNyUD//EABgQAAMBAQAAAAAAAAAAAAAAAAABEgIQ/9oACAEBAAEFAnkkgff/xAAXEQADAQAAAAAAAAAAAAAAAAAAARES/9oACAEDAQE/AdMrP//EABcRAAMBAAAAAAAAAAAAAAAAAAABERL/2gAIAQIBAT8ByiI//8QAGRAAAgMBAAAAAAAAAAAAAAAAAZEAIDEy/9oACAEBAAY/AtLnRc0un//EABkQAQEBAAMAAAAAAAAAAAAAAAEAERAhQf/aAAgBAQABPyE92QWYC3mDrj//2gAMAwEAAgADAAAAEPzv/8QAFREBAQAAAAAAAAAAAAAAAAAAAGH/2gAIAQMBAT8Qos//xAAVEQEBAAAAAAAAAAAAAAAAAAAAYf/aAAgBAgEBPxCCT//EABwQAQACAgMBAAAAAAAAAAAAAAEAESExEFFxwf/aAAgBAQABPxA+Gt0ICNfVANvqmWXcJs3fvH//2Q==')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Empty TensorBoard Panel\",\"title\":\"Empty TensorBoard Panel\",\"src\":\"/static/95e5581c409416c73ade13bd383b8274/a2510/22.jpg\",\"srcSet\":[\"/static/95e5581c409416c73ade13bd383b8274/0479a/22.jpg 250w\",\"/static/95e5581c409416c73ade13bd383b8274/41099/22.jpg 500w\",\"/static/95e5581c409416c73ade13bd383b8274/a2510/22.jpg 1000w\",\"/static/95e5581c409416c73ade13bd383b8274/c58a3/22.jpg 1500w\",\"/static/95e5581c409416c73ade13bd383b8274/5ed7a/22.jpg 1832w\"],\"sizes\":\"(max-width: 1000px) 100vw, 1000px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,\"After the model training is be started you may get back to this panel and see the training process progress.\"),mdx(\"h2\",{\"id\":\"Ô∏è-model-training\",\"style\":{\"position\":\"relative\"}},\"\\uD83C\\uDFCB\\uD83C\\uDFFB\\u200D\\uFE0F Model Training\",mdx(\"a\",{parentName:\"h2\",\"href\":\"#%EF%B8%8F-model-training\",\"aria-label\":\"Ô∏è model training permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"h3\",{\"id\":\"configuring-the-detection-pipeline\",\"style\":{\"position\":\"relative\"}},\"Configuring the Detection Pipeline\",mdx(\"a\",{parentName:\"h3\",\"href\":\"#configuring-the-detection-pipeline\",\"aria-label\":\"configuring the detection pipeline permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"Now it's time to get back to the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"cache/datasets/ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8/pipeline.config\"),\" file that we've mentioned earlier. This file defines the parameters of \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8\"),\" model training.\"),mdx(\"p\",null,\"We need to copy the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"pipeline.config\"),\" file to the root of the project and adjust a couple of things in it:\"),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},\"We should change the \",mdx(\"strong\",{parentName:\"li\"},\"number of classes\"),\" from \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"90\"),\" (the COCO classes) to just \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"1\"),\" (the \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"http\"),\" class).\"),mdx(\"li\",{parentName:\"ol\"},\"We should reduce the \",mdx(\"strong\",{parentName:\"li\"},\"batch size\"),\" to \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"8\"),\" to avoid the errors that are connected to the insufficient memory.\"),mdx(\"li\",{parentName:\"ol\"},\"We need to point the model to its \",mdx(\"strong\",{parentName:\"li\"},\"checkpoints\"),\" since we don't want to train the model from scratch.\"),mdx(\"li\",{parentName:\"ol\"},\"We need to change the \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"fine_tune_checkpoint_type\"),\" to \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"detection\"),\".\"),mdx(\"li\",{parentName:\"ol\"},\"We need to point the model to a proper \",mdx(\"strong\",{parentName:\"li\"},\"labels map\"),\".\"),mdx(\"li\",{parentName:\"ol\"},\"Lastly, we need to pint the model to the \",mdx(\"strong\",{parentName:\"li\"},\"train and test datasets\"),\".\")),mdx(\"p\",null,\"All these changes may be done manually directly in \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"pipeline.config\"),\" file. But we may also do them through code:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" tensorflow \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" tf\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" shutil \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" copyfile\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" google\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"protobuf \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" text_format\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" object_detection\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"protos \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" pipeline_pb2\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Adjust pipeline config modification here if needed.\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"modify_config\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"pipeline\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Model config.\"),\"\\n    pipeline\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"model\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"ssd\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"num_classes \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Train config.\"),\"\\n    pipeline\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"train_config\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"batch_size \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"8\"),\"\\n\\n    pipeline\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"train_config\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"fine_tune_checkpoint \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'cache/datasets/ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8/checkpoint/ckpt-0'\"),\"\\n    pipeline\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"train_config\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"fine_tune_checkpoint_type \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'detection'\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Train input reader config.\"),\"\\n    pipeline\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"train_input_reader\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"label_map_path \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/labels/label_map.pbtxt'\"),\"\\n    pipeline\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"train_input_reader\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"tf_record_input_reader\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"input_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/tfrecords/train.record'\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Eval input reader config.\"),\"\\n    pipeline\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"eval_input_reader\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"label_map_path \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/labels/label_map.pbtxt'\"),\"\\n    pipeline\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"eval_input_reader\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"tf_record_input_reader\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"input_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/tfrecords/test.record'\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" pipeline\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"clone_pipeline_config\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    copyfile\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'cache/datasets/ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8/pipeline.config'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'pipeline.config'\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"setup_pipeline\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"pipeline_config_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    clone_pipeline_config\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    pipeline \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" read_pipeline_config\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"pipeline_config_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    pipeline \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" modify_config\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"pipeline\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    write_pipeline_config\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"pipeline_config_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" pipeline\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" pipeline\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"read_pipeline_config\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"pipeline_config_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    pipeline \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" pipeline_pb2\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"TrainEvalPipelineConfig\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"with\"),\" tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"io\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"gfile\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"GFile\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"pipeline_config_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"\\\"r\\\"\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" f\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        proto_str \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" f\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"read\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        text_format\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Merge\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"proto_str\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" pipeline\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" pipeline\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"write_pipeline_config\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"pipeline_config_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" pipeline\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    config_text \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" text_format\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"MessageToString\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"pipeline\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"with\"),\" tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"io\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"gfile\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"GFile\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"pipeline_config_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"\\\"wb\\\"\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" f\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        f\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"write\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"config_text\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Adjusting the pipeline configuration.\"),\"\\npipeline \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" setup_pipeline\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'pipeline.config'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"pipeline\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"p\",null,\"Here is the content of the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"pipeline.config\"),\" file:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"model {\\n  ssd {\\n    num_classes: 1\\n    image_resizer {\\n      fixed_shape_resizer {\\n        height: 640\\n        width: 640\\n      }\\n    }\\n    feature_extractor {\\n      type: \\\"ssd_mobilenet_v2_fpn_keras\\\"\\n      depth_multiplier: 1.0\\n      min_depth: 16\\n      conv_hyperparams {\\n        regularizer {\\n          l2_regularizer {\\n            weight: 3.9999998989515007e-05\\n          }\\n        }\\n        initializer {\\n          random_normal_initializer {\\n            mean: 0.0\\n            stddev: 0.009999999776482582\\n          }\\n        }\\n        activation: RELU_6\\n        batch_norm {\\n          decay: 0.996999979019165\\n          scale: true\\n          epsilon: 0.0010000000474974513\\n        }\\n      }\\n      use_depthwise: true\\n      override_base_feature_extractor_hyperparams: true\\n      fpn {\\n        min_level: 3\\n        max_level: 7\\n        additional_layer_depth: 128\\n      }\\n    }\\n    box_coder {\\n      faster_rcnn_box_coder {\\n        y_scale: 10.0\\n        x_scale: 10.0\\n        height_scale: 5.0\\n        width_scale: 5.0\\n      }\\n    }\\n    matcher {\\n      argmax_matcher {\\n        matched_threshold: 0.5\\n        unmatched_threshold: 0.5\\n        ignore_thresholds: false\\n        negatives_lower_than_unmatched: true\\n        force_match_for_each_row: true\\n        use_matmul_gather: true\\n      }\\n    }\\n    similarity_calculator {\\n      iou_similarity {\\n      }\\n    }\\n    box_predictor {\\n      weight_shared_convolutional_box_predictor {\\n        conv_hyperparams {\\n          regularizer {\\n            l2_regularizer {\\n              weight: 3.9999998989515007e-05\\n            }\\n          }\\n          initializer {\\n            random_normal_initializer {\\n              mean: 0.0\\n              stddev: 0.009999999776482582\\n            }\\n          }\\n          activation: RELU_6\\n          batch_norm {\\n            decay: 0.996999979019165\\n            scale: true\\n            epsilon: 0.0010000000474974513\\n          }\\n        }\\n        depth: 128\\n        num_layers_before_predictor: 4\\n        kernel_size: 3\\n        class_prediction_bias_init: -4.599999904632568\\n        share_prediction_tower: true\\n        use_depthwise: true\\n      }\\n    }\\n    anchor_generator {\\n      multiscale_anchor_generator {\\n        min_level: 3\\n        max_level: 7\\n        anchor_scale: 4.0\\n        aspect_ratios: 1.0\\n        aspect_ratios: 2.0\\n        aspect_ratios: 0.5\\n        scales_per_octave: 2\\n      }\\n    }\\n    post_processing {\\n      batch_non_max_suppression {\\n        score_threshold: 9.99999993922529e-09\\n        iou_threshold: 0.6000000238418579\\n        max_detections_per_class: 100\\n        max_total_detections: 100\\n        use_static_shapes: false\\n      }\\n      score_converter: SIGMOID\\n    }\\n    normalize_loss_by_num_matches: true\\n    loss {\\n      localization_loss {\\n        weighted_smooth_l1 {\\n        }\\n      }\\n      classification_loss {\\n        weighted_sigmoid_focal {\\n          gamma: 2.0\\n          alpha: 0.25\\n        }\\n      }\\n      classification_weight: 1.0\\n      localization_weight: 1.0\\n    }\\n    encode_background_as_zeros: true\\n    normalize_loc_loss_by_codesize: true\\n    inplace_batchnorm_update: true\\n    freeze_batchnorm: false\\n  }\\n}\\ntrain_config {\\n  batch_size: 8\\n  data_augmentation_options {\\n    random_horizontal_flip {\\n    }\\n  }\\n  data_augmentation_options {\\n    random_crop_image {\\n      min_object_covered: 0.0\\n      min_aspect_ratio: 0.75\\n      max_aspect_ratio: 3.0\\n      min_area: 0.75\\n      max_area: 1.0\\n      overlap_thresh: 0.0\\n    }\\n  }\\n  sync_replicas: true\\n  optimizer {\\n    momentum_optimizer {\\n      learning_rate {\\n        cosine_decay_learning_rate {\\n          learning_rate_base: 0.07999999821186066\\n          total_steps: 50000\\n          warmup_learning_rate: 0.026666000485420227\\n          warmup_steps: 1000\\n        }\\n      }\\n      momentum_optimizer_value: 0.8999999761581421\\n    }\\n    use_moving_average: false\\n  }\\n  fine_tune_checkpoint: \\\"cache/datasets/ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8/checkpoint/ckpt-0\\\"\\n  num_steps: 50000\\n  startup_delay_steps: 0.0\\n  replicas_to_aggregate: 8\\n  max_number_of_boxes: 100\\n  unpad_groundtruth_tensors: false\\n  fine_tune_checkpoint_type: \\\"detection\\\"\\n  fine_tune_checkpoint_version: V2\\n}\\ntrain_input_reader {\\n  label_map_path: \\\"dataset/printed_links/labels/label_map.pbtxt\\\"\\n  tf_record_input_reader {\\n    input_path: \\\"dataset/printed_links/tfrecords/train.record\\\"\\n  }\\n}\\neval_config {\\n  metrics_set: \\\"coco_detection_metrics\\\"\\n  use_moving_averages: false\\n}\\neval_input_reader {\\n  label_map_path: \\\"dataset/printed_links/labels/label_map.pbtxt\\\"\\n  shuffle: false\\n  num_epochs: 1\\n  tf_record_input_reader {\\n    input_path: \\\"dataset/printed_links/tfrecords/test.record\\\"\\n  }\\n}\"))),mdx(\"h3\",{\"id\":\"launching-the-training-process\",\"style\":{\"position\":\"relative\"}},\"Launching the training process\",mdx(\"a\",{parentName:\"h3\",\"href\":\"#launching-the-training-process\",\"aria-label\":\"launching the training process permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"We're ready now to launch a training process using the TensorFlow 2 Object Detection API. The API contains a \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/tensorflow/models/blob/master/research/object_detection/model_main_tf2.py\"},\"model_main_tf2.py\"),\" script that will run training for us. Feel free to explore the flags that this Python script supports in the source-code (i.e. \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"num_train_steps\"),\", \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"model_dir\"),\" and others) to see their meanings.\"),mdx(\"p\",null,\"We will be training the model for \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"1000\"),\" iterations (epochs). Feel free to train it for a smaller or larger number of iterations depending on the learning progress (see the TensorBoard charts).\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"bash\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-bash\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-bash\"},\"%%bash\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token assign-left variable\"},\"NUM_TRAIN_STEPS\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1000\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token assign-left variable\"},\"CHECKPOINT_EVERY_N\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1000\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token assign-left variable\"},\"PIPELINE_CONFIG_PATH\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"pipeline.config\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token assign-left variable\"},\"MODEL_DIR\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"./logs\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token assign-left variable\"},\"SAMPLE_1_OF_N_EVAL_EXAMPLES\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1\"),\"\\n\\npython ./models/research/object_detection/model_main_tf2.py \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"\\\\\"),\"\\n  --model_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token variable\"},\"$MODEL_DIR\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"\\\\\"),\"\\n  --num_train_steps\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token variable\"},\"$NUM_TRAIN_STEPS\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"\\\\\"),\"\\n  --sample_1_of_n_eval_examples\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token variable\"},\"$SAMPLE_1_OF_N_EVAL_EXAMPLES\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"\\\\\"),\"\\n  --pipeline_config_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token variable\"},\"$PIPELINE_CONFIG_PATH\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"\\\\\"),\"\\n  --checkpoint_every_n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token variable\"},\"$CHECKPOINT_EVERY_N\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"\\\\\"),\"\\n  --alsologtostderr\"))),mdx(\"p\",null,\"While the model is training (it may take around\",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"~10 minutes\"),\" for \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"1000\"),\" iterations in \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://colab.research.google.com/notebooks/gpu.ipynb\"},\"GoogleColab GPU\"),\" runtime) you should be able to observe the training progress in TensorBoard. The \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"localization\"),\" and \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"classification\"),\" losses should decrease which means that the model is doing a good job in localizing and classifying new custom objects.\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"1000px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"46.800000000000004%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAgABBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEA/9oADAMBAAIQAxAAAAHtakJlR//EABcQAAMBAAAAAAAAAAAAAAAAAAABEiD/2gAIAQEAAQUClEolY//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/Aar/xAAWEQEBAQAAAAAAAAAAAAAAAAAAEQH/2gAIAQIBAT8BmI//xAAXEAADAQAAAAAAAAAAAAAAAAAAATEg/9oACAEBAAY/AoiIix//xAAZEAACAwEAAAAAAAAAAAAAAAAA8QEQQeH/2gAIAQEAAT8hjjC4TG3/AP/aAAwDAQACAAMAAAAQ4B//xAAWEQADAAAAAAAAAAAAAAAAAAAAEVH/2gAIAQMBAT8QajU//8QAFxEBAAMAAAAAAAAAAAAAAAAAABFRYf/aAAgBAgEBPxDBCn//xAAcEAACAQUBAAAAAAAAAAAAAAAAAREQITFxofH/2gAIAQEAAT8QjXm0E2VwnmRYUZ//2Q==')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Training Process\",\"title\":\"Training Process\",\"src\":\"/static/f0ee38bedbfe135b3b118411cdb68c50/a2510/23.jpg\",\"srcSet\":[\"/static/f0ee38bedbfe135b3b118411cdb68c50/0479a/23.jpg 250w\",\"/static/f0ee38bedbfe135b3b118411cdb68c50/41099/23.jpg 500w\",\"/static/f0ee38bedbfe135b3b118411cdb68c50/a2510/23.jpg 1000w\",\"/static/f0ee38bedbfe135b3b118411cdb68c50/c58a3/23.jpg 1500w\",\"/static/f0ee38bedbfe135b3b118411cdb68c50/3acf0/23.jpg 2000w\",\"/static/f0ee38bedbfe135b3b118411cdb68c50/8b3ab/23.jpg 2390w\"],\"sizes\":\"(max-width: 1000px) 100vw, 1000px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,\"Also during the training, the new model checkpoints (parameters that the model has learned during the training) will be saved to the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"logs\"),\" folder.\"),mdx(\"p\",null,\"The \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"logs\"),\" folder structure now looks like this:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"logs\\n\\u251C\\u2500\\u2500 checkpoint\\n\\u251C\\u2500\\u2500 ckpt-1.data-00000-of-00001\\n\\u251C\\u2500\\u2500 ckpt-1.index\\n\\u2514\\u2500\\u2500 train\\n    \\u2514\\u2500\\u2500 events.out.tfevents.1606560330.b314c371fa10.1747.1628.v2\"))),mdx(\"h3\",{\"id\":\"evaluating-the-model-optional\",\"style\":{\"position\":\"relative\"}},\"Evaluating the Model (Optional)\",mdx(\"a\",{parentName:\"h3\",\"href\":\"#evaluating-the-model-optional\",\"aria-label\":\"evaluating the model optional permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"The evaluation process uses the trained model checkpoints and evaluates how well the model performs in detecting objects in the test dataset. The results of this evaluation are summarised in the form of some \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/evaluation_protocols.md\"},\"metrics\"),\", which can be examined over time. You may read more about how to evaluate these metrics \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://tensorflow-object-detection-api-tutorial.readthedocs.io/en/latest/training.html#evaluating-the-model-optional\"},\"here\"),\".\"),mdx(\"p\",null,\"We will skip the metrics evaluation step in this article. But we may still use the evaluation step to see the model's detections in TensorBoard:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"bash\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-bash\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-bash\"},\"%%bash\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token assign-left variable\"},\"PIPELINE_CONFIG_PATH\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"pipeline.config\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token assign-left variable\"},\"MODEL_DIR\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"logs\\n\\npython ./models/research/object_detection/model_main_tf2.py \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"\\\\\"),\"\\n  --model_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token variable\"},\"$MODEL_DIR\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"\\\\\"),\"\\n  --pipeline_config_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token variable\"},\"$PIPELINE_CONFIG_PATH\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"\\\\\"),\"\\n  --checkpoint_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token variable\"},\"$MODEL_DIR\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"\\\\\")))),mdx(\"p\",null,\"After launching the script you should be able to see several side-by-side images with detections boxes:\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"1000px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"42%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAAB2LGWQ3//xAAWEAADAAAAAAAAAAAAAAAAAAAAAhL/2gAIAQEAAQUClSFIU//EABYRAAMAAAAAAAAAAAAAAAAAAAABEf/aAAgBAwEBPwGsrP/EABcRAAMBAAAAAAAAAAAAAAAAAAABERL/2gAIAQIBAT8ByiI//8QAFxAAAwEAAAAAAAAAAAAAAAAAAAExMv/aAAgBAQAGPwKIyiI//8QAGBAAAgMAAAAAAAAAAAAAAAAAAAEh0fH/2gAIAQEAAT8hiBNoMo//2gAMAwEAAgADAAAAEAvP/8QAFREBAQAAAAAAAAAAAAAAAAAAAGH/2gAIAQMBAT8Qss//xAAVEQEBAAAAAAAAAAAAAAAAAAAAYf/aAAgBAgEBPxCKT//EABkQAAMAAwAAAAAAAAAAAAAAAAABESExkf/aAAgBAQABPxC7Nci3MAjoH//Z')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Model Evaluation\",\"title\":\"Model Evaluation\",\"src\":\"/static/4e770b2825aa52724dd190abec9b4384/a2510/24.jpg\",\"srcSet\":[\"/static/4e770b2825aa52724dd190abec9b4384/0479a/24.jpg 250w\",\"/static/4e770b2825aa52724dd190abec9b4384/41099/24.jpg 500w\",\"/static/4e770b2825aa52724dd190abec9b4384/a2510/24.jpg 1000w\",\"/static/4e770b2825aa52724dd190abec9b4384/c58a3/24.jpg 1500w\",\"/static/4e770b2825aa52724dd190abec9b4384/3acf0/24.jpg 2000w\",\"/static/4e770b2825aa52724dd190abec9b4384/56873/24.jpg 2332w\"],\"sizes\":\"(max-width: 1000px) 100vw, 1000px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"h2\",{\"id\":\"-exporting-the-model\",\"style\":{\"position\":\"relative\"}},\"\\uD83D\\uDDDC Exporting the Model\",mdx(\"a\",{parentName:\"h2\",\"href\":\"#-exporting-the-model\",\"aria-label\":\" exporting the model permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"Once the training process is complete we should save the trained model for further usage. To export the model we will use the \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/tensorflow/models/blob/master/research/object_detection/exporter_main_v2.py\"},\"exporter_main_v2.py\"),\" script from Object Detection API. It prepares an object detection TensorFlow graph for inference using model configuration and a trained checkpoint. The script outputs associated checkpoint files, a SavedModel, and a copy of the model config:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"bash\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-bash\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-bash\"},\"%%bash\\n\\npython ./models/research/object_detection/exporter_main_v2.py \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"\\\\\"),\"\\n    --input_type\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"image_tensor \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"\\\\\"),\"\\n    --pipeline_config_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"pipeline.config \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"\\\\\"),\"\\n    --trained_checkpoint_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"logs \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"\\\\\"),\"\\n    --output_directory\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"exported/ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8\"))),mdx(\"p\",null,\"Here is what the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"exported\"),\" folder contains after the export:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"exported\\n\\u2514\\u2500\\u2500 ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8\\n    \\u251C\\u2500\\u2500 checkpoint\\n    \\u2502   \\u251C\\u2500\\u2500 checkpoint\\n    \\u2502   \\u251C\\u2500\\u2500 ckpt-0.data-00000-of-00001\\n    \\u2502   \\u2514\\u2500\\u2500 ckpt-0.index\\n    \\u251C\\u2500\\u2500 pipeline.config\\n    \\u2514\\u2500\\u2500 saved_model\\n        \\u251C\\u2500\\u2500 assets\\n        \\u251C\\u2500\\u2500 saved_model.pb\\n        \\u2514\\u2500\\u2500 variables\\n            \\u251C\\u2500\\u2500 variables.data-00000-of-00001\\n            \\u2514\\u2500\\u2500 variables.index\"))),mdx(\"p\",null,\"At this moment we have a \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"saved_model\"),\" that may be used for inference.\"),mdx(\"h2\",{\"id\":\"-using-the-exported-model\",\"style\":{\"position\":\"relative\"}},\"\\uD83D\\uDE80 Using the Exported Model\",mdx(\"a\",{parentName:\"h2\",\"href\":\"#-using-the-exported-model\",\"aria-label\":\" using the exported model permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"Let's see how can we use the saved model from the previous step for object detections.\"),mdx(\"p\",null,\"First, we need to create a detection function that will use the saved model. It will accept the image and will output the detected objects:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" time\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" math\\n\\nPATH_TO_SAVED_MODEL \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'exported/ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8/saved_model'\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"detection_function_from_saved_model\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"saved_model_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'Loading saved model...'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" end\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"''\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    start_time \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" time\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"time\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Load saved model and build the detection function\"),\"\\n    detect_fn \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"saved_model\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"load\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"saved_model_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    end_time \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" time\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"time\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    elapsed_time \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" end_time \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"-\"),\" start_time\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'Done! Took {} seconds'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"format\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"math\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"ceil\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"elapsed_time\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" detect_fn\\n\\nexported_detect_fn \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" detection_function_from_saved_model\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n    PATH_TO_SAVED_MODEL\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"p\",null,mdx(\"em\",{parentName:\"p\"},\"output \\u2192\")),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"Loading saved model...Done! Took 9 seconds\"))),mdx(\"p\",null,\"To map the IDs of the detected classes back to the class names we need to load the label map as well:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" object_detection\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"utils \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" label_map_util\\n\\ncategory_index \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" label_map_util\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"create_category_index_from_labelmap\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/labels/label_map.pbtxt'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    use_display_name\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"True\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"category_index\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"p\",null,mdx(\"em\",{parentName:\"p\"},\"output \\u2192\")),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"{1: {'id': 1, 'name': 'http'}}\"))),mdx(\"p\",null,\"Testing the model on a test dataset.\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" matplotlib\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"pyplot \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" plt\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" tensorflow \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" tf\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" numpy \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" np\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" object_detection\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"utils \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" visualization_utils\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" object_detection\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"data_decoders\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"tf_example_decoder \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" TfExampleDecoder\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"%\"),\"matplotlib inline\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"tensors_from_tfrecord\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n    tfrecords_filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    tfrecords_num\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    dtype\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"float32\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    decoder \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" TfExampleDecoder\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    raw_dataset \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"data\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"TFRecordDataset\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"tfrecords_filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    images \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"for\"),\" raw_record \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"in\"),\" raw_dataset\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"take\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"tfrecords_num\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        example \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" decoder\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"decode\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"raw_record\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        image \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" example\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'image'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\"\\n        image \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"cast\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" dtype\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"dtype\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        images\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"append\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" images\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"test_detection\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"tfrecords_filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" tfrecords_num\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" detect_fn\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    image_tensors \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" tensors_from_tfrecord\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n        tfrecords_filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        tfrecords_num\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n        dtype\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"uint8\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"for\"),\" image_tensor \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"in\"),\" image_tensors\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n        image_np \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" image_tensor\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"numpy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# The model expects a batch of images, so add an axis with `tf.newaxis`.\"),\"\\n        input_tensor \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"expand_dims\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image_tensor\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        detections \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" detect_fn\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"input_tensor\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# All outputs are batches tensors.\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# Convert to numpy arrays, and take index [0] to remove the batch dimension.\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# We're only interested in the first num_detections.\"),\"\\n        num_detections \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"int\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"pop\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'num_detections'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        detections \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"{\"),\"key\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\" value\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"0\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"num_detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"numpy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"for\"),\" key\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" value \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"in\"),\" detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"items\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"}\"),\"\\n        detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'num_detections'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" num_detections\\n\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token comment\"},\"# detection_classes should be ints.\"),\"\\n        detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'detection_classes'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'detection_classes'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"astype\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"np\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"int64\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        image_np_with_detections \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" image_np\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"astype\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"int\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"copy\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        visualization_utils\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"visualize_boxes_and_labels_on_image_array\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n            image_np_with_detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n            detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'detection_boxes'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n            detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'detection_classes'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n            detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"[\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'detection_scores'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"]\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n            category_index\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n            use_normalized_coordinates\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"True\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n            max_boxes_to_draw\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"100\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n            min_score_thresh\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\".3\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n            agnostic_mode\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token boolean\"},\"False\"),\"\\n        \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n        plt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"figure\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"figsize\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"8\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"8\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n        plt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"imshow\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"image_np_with_detections\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n    plt\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"show\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\\n\\ntest_detection\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"\\n    tfrecords_filename\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'dataset/printed_links/tfrecords/test.record'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    tfrecords_num\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"10\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\",\"),\"\\n    detect_fn\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"exported_detect_fn\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"p\",null,\"As a result, you should see \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"10\"),\" images from the test dataset and highlighted \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"https:\"),\" prefixes that were detected by the model:\"),mdx(\"p\",null,mdx(\"span\",{parentName:\"p\",\"className\":\"gatsby-resp-image-wrapper\",\"style\":{\"position\":\"relative\",\"display\":\"block\",\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"976px\"}},\"\\n      \",mdx(\"span\",{parentName:\"span\",\"className\":\"gatsby-resp-image-background-image\",\"style\":{\"paddingBottom\":\"98%\",\"position\":\"relative\",\"bottom\":\"0\",\"left\":\"0\",\"backgroundImage\":\"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHvspJUGlQgH//EABgQAAMBAQAAAAAAAAAAAAAAAAABERAC/9oACAEBAAEFAsQ85IQkP//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABcQAAMBAAAAAAAAAAAAAAAAAAEQIHH/2gAIAQEABj8CRZ2P/8QAGxAAAwACAwAAAAAAAAAAAAAAAAEhEYFBcaH/2gAIAQEAAT8hIPexC2aYxPIx8FXHNP/aAAwDAQACAAMAAAAQIMAA/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAHhABAAMAAgIDAAAAAAAAAAAAAQARITFxQVGRwfH/2gAIAQEAAT8QKral+xAdbr6kBcbad7liX8E25fggoFXWNHL5QWG0rX1P/9k=')\",\"backgroundSize\":\"cover\",\"display\":\"block\"}}),\"\\n  \",mdx(\"img\",{parentName:\"span\",\"className\":\"gatsby-resp-image-image\",\"alt\":\"Testing the model on a test dataset\",\"title\":\"Testing the model on a test dataset\",\"src\":\"/static/61aef315a3caa1f60ef57bf4df5c450f/03073/25.jpg\",\"srcSet\":[\"/static/61aef315a3caa1f60ef57bf4df5c450f/0479a/25.jpg 250w\",\"/static/61aef315a3caa1f60ef57bf4df5c450f/41099/25.jpg 500w\",\"/static/61aef315a3caa1f60ef57bf4df5c450f/03073/25.jpg 976w\"],\"sizes\":\"(max-width: 976px) 100vw, 976px\",\"style\":{\"width\":\"100%\",\"height\":\"100%\",\"margin\":\"0\",\"verticalAlign\":\"middle\",\"position\":\"absolute\",\"top\":\"0\",\"left\":\"0\"},\"loading\":\"lazy\"}),\"\\n    \")),mdx(\"p\",null,\"The fact that the model is able to detect custom objects (in our case the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"https://\"),\" prefixes) on the images it hasn't seen before is a good sign and something that we wanted to achieve.\"),mdx(\"h2\",{\"id\":\"-converting-the-model-for-web\",\"style\":{\"position\":\"relative\"}},\"\\uD83D\\uDDDC Converting the Model for Web\",mdx(\"a\",{parentName:\"h2\",\"href\":\"#-converting-the-model-for-web\",\"aria-label\":\" converting the model for web permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"As you remember from the beginning of this article, our goal was to use the custom object detection model in the browser. Luckily, there is a \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://www.tensorflow.org/js\"},\"TensorFlow.js\"),\" JavaScript version of the TensorFlow library exists. In JavaScript, we can't work with our saved model directly. Instead, we need to convert it to \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://www.tensorflow.org/js/tutorials/conversion/import_saved_model\"},\"tfjs_graph_model\"),\" format.\"),mdx(\"p\",null,\"To do this we need to install the tensorflowjs Python package:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"bash\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-bash\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-bash\"},\"pip \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"install\"),\" tensorflowjs --quiet\"))),mdx(\"p\",null,\"The model may be exported like this:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"bash\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-bash\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-bash\"},\"%%bash\\n\\ntensorflowjs_converter \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"\\\\\"),\"\\n    --input_format\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"tf_saved_model \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"\\\\\"),\"\\n    --output_format\",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\"tfjs_graph_model \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"\\\\\"),\"\\n    exported/ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8/saved_model \",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"\\\\\"),\"\\n    exported_web/ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8\"))),mdx(\"p\",null,\"The \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"exported_web\"),\" folder contains the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\".json\"),\" file with the model metadata and a bunch of \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\".bin\"),\" files with trained model parameters:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"exported_web\\n\\u2514\\u2500\\u2500 ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8\\n    \\u251C\\u2500\\u2500 group1-shard1of4.bin\\n    \\u251C\\u2500\\u2500 group1-shard2of4.bin\\n    \\u251C\\u2500\\u2500 group1-shard3of4.bin\\n    \\u251C\\u2500\\u2500 group1-shard4of4.bin\\n    \\u2514\\u2500\\u2500 model.json\"))),mdx(\"p\",null,\"Finally, we have the model that is able to detect \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"https://\"),\" prefixes for us, and it is saved in JavaScript-understandable format.\"),mdx(\"p\",null,\"Let's check the model size to see if it is light enough to be loaded completely to the client-side:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"python\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-python\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-python\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" pathlib\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"def\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"get_folder_size\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"folder_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\":\"),\"\\n    mB \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token number\"},\"1000000\"),\"\\n    root_dir \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" pathlib\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"Path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"folder_path\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    sizeBytes \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token builtin\"},\"sum\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"f\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"stat\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"st_size \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"for\"),\" f \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"in\"),\" root_dir\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"glob\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'**/*'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"if\"),\" f\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),\"is_file\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n    \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"return\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string-interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"f'\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"sizeBytes\",mdx(\"span\",{parentName:\"span\",\"className\":\"token operator\"},\"//\"),\"mB\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\" MB'\")),\"\\n\\n\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string-interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"f'Original model size:      \"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"get_folder_size\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"\\\"cache/datasets/ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8\\\"\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"'\")),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string-interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"f'Exported model size:      \"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"get_folder_size\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"\\\"exported/ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8\\\"\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"'\")),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"print\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token string-interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"f'Exported WEB model size:  \"),mdx(\"span\",{parentName:\"span\",\"className\":\"token interpolation\"},mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"{\"),\"get_folder_size\",mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"(\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"\\\"exported_web/ssd_mobilenet_v2_fpnlite_640x640_coco17_tpu-8\\\"\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"span\",\"className\":\"token punctuation\"},\"}\")),mdx(\"span\",{parentName:\"span\",\"className\":\"token string\"},\"'\")),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\")))),mdx(\"p\",null,mdx(\"em\",{parentName:\"p\"},\"output \\u2192\")),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"text\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},\"Original model size:      31 MB\\nExported model size:      28 MB\\nExported WEB model size:  13 MB\"))),mdx(\"p\",null,\"As you may see the model that we're going to use for the Web has \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"13MB\"),\" which is quite acceptable in our case.\"),mdx(\"p\",null,\"Later in JavaScript we may start using the model like this:\"),mdx(\"div\",{\"className\":\"gatsby-highlight\",\"data-language\":\"javascript\"},mdx(\"pre\",{parentName:\"div\",\"className\":\"language-javascript\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-javascript\"},mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"import\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"*\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"as\"),\" tf \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"from\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token string\"},\"'@tensorflow/tfjs'\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\";\"),\"\\n\",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"const\"),\" model \",mdx(\"span\",{parentName:\"code\",\"className\":\"token operator\"},\"=\"),\" \",mdx(\"span\",{parentName:\"code\",\"className\":\"token keyword\"},\"await\"),\" tf\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\".\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token function\"},\"loadGraphModel\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\"(\"),\"modelURL\",mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\")\"),mdx(\"span\",{parentName:\"code\",\"className\":\"token punctuation\"},\";\")))),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},\"\\uD83E\\uDDED The next step is to implement the Links Detector UI which will use this model, but this is another story for another article. The final source code of the application may be found in \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/trekhleb/links-detector\"},\"links-detector repository\"),\" on GitHub.\")),mdx(\"h2\",{\"id\":\"-conclusions\",\"style\":{\"position\":\"relative\"}},\"\\uD83E\\uDD14 Conclusions\",mdx(\"a\",{parentName:\"h2\",\"href\":\"#-conclusions\",\"aria-label\":\" conclusions permalink\",\"className\":\"gatsby-remark-autolink-header-anchor after\"},mdx(\"svg\",{parentName:\"a\",\"aria-hidden\":\"true\",\"focusable\":\"false\",\"height\":\"16\",\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\",\"width\":\"16\"},mdx(\"path\",{parentName:\"svg\",\"fillRule\":\"evenodd\",\"d\":\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"})))),mdx(\"p\",null,\"In this article, we started to solve the issue with printed links detection. We ended up creating the custom object detector to recognize the \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"https://\"),\" prefixes on text images (i.e. on smartphone camera stream images). We have also converted the model to a \",mdx(\"code\",{parentName:\"p\",\"className\":\"language-text\"},\"tfjs_graph_model\"),\" to be able to re-use it on the client-side.\"),mdx(\"p\",null,\"You may \\uD83D\\uDE80 \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://trekhleb.dev/links-detector/\"},\"launch Links Detector demo\"),\" from your smartphone to see the final result and to try how the model performs on your books or magazines.\"),mdx(\"p\",null,\"Here is how the final solution looks like:\"),mdx(\"p\",null,mdx(\"img\",{parentName:\"p\",\"src\":\"/posts-assets/2dc300f4cc152c8b14200c25eba77a02/26.gif\",\"alt\":\"Links Detector Demo\"})),mdx(\"p\",null,\"You may also \\uD83D\\uDCDD \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/trekhleb/links-detector\"},\"browse the links-detector repository\"),\" on GitHub to see the complete source code of the UI part of the application.\"),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},\"\\u26A0\\uFE0F Currently the application is in \",mdx(\"em\",{parentName:\"p\"},\"experimental\"),\" \",mdx(\"em\",{parentName:\"p\"},\"Alpha\"),\" stage and has \",mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/trekhleb/links-detector/issues?q=is%3Aopen+is%3Aissue+label%3Aenhancement\"},\"many issues and limitations\"),\". So don't raise your expectations level too high until these issues are resolved \\uD83E\\uDD37\\uD83C\\uDFFB\\u200D.\")),mdx(\"p\",null,\"As the next steps which might improve the model performance we might do the following:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"Extend the dataset with more link types (\",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"http://\"),\", \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"tcp://\"),\", \",mdx(\"code\",{parentName:\"li\",\"className\":\"language-text\"},\"ftp://\"),\" etc)\"),mdx(\"li\",{parentName:\"ul\"},\"Extended the dataset with images that have dark backgrounds\"),mdx(\"li\",{parentName:\"ul\"},\"Extend the dataset with underlined links\"),mdx(\"li\",{parentName:\"ul\"},\"Extend the dataset with examples of different fonts and ligatures\"),mdx(\"li\",{parentName:\"ul\"},\"etc.\")),mdx(\"p\",null,\"Even though the model has a lot to be improved to make it closer to the production-ready state, I still hope that this article was useful for you and gave you some guidelines and inspiration to play around with your custom object detectors.\"),mdx(\"p\",null,\"Happy training, folks!\"));};MDXContent.isMDXComponent=true;","fields":{"slug":"/blog/2020/printed-links-detection/"},"frontmatter":{"title":"Making the Printed Links Clickable Using TensorFlow 2 Object Detection API","summary":"In this article we will start solving the issue of making the printed links (i.e. in a book or in a magazine) clickable via your smartphone camera","date":"01 December, 2020","cover":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB9UlEQVQoz32RS2saYRSGzcyotEhBEATXXhDB2z9QcCUiiEsRV20VQ4iGtlDiou3CUrKVtEHBRTd2LBgbDMxYQkcrSqmWar1kHMe5qjHa2D/Qz5hVQvsuDi+H83BuEskdQRAEosViyWQytVqt1Wr1ej2SJDudTrPZLJVKqVQqFArJZLJ19da1bsFGozGbzfb7/W63y3GcKIo8zzMMA/hCoRCNRhEEud0WhmG5XA6MzWbL5XI0TQNytVotFourq9Xl5RKY4ZBKJBKbMolSqdRoNFqtVqVSeb3eYDAIkiaTCcdxUDqbTQE8n18sl/M/q9/TqTAR+WQyqVAo1rDZbPZ4PIFAwOVyORwOt9u92blYLE4mE4YZC+IFR9ep5v7gW6L99Vmv/vT1q0f37j+QbCYMh8M+nw9gfr/f6XRuOqMoyrLMiBoyDCtwJE9XxuSXQQdrN0/2n8e2IHgNq9Vqu91utVpBNzCFTqcDSRDT6XTn1/mIFuixMKJFll9S9OzHT5IgGru7cXCdm/MCB10LGKlUCpJ6vf7g4M2g/YklMZ4qC/RnjsLZIX7e/oifvo9u7yAILPnXn3U6/csXierpztnx40Y53ijHvp89qWOxysnD4w/J6Hb8f7DBYIjv7R0evs3n8wRBVCqVarWKYRiK5t8dHUUiEfDnv32o+RUIAIbfAAAAAElFTkSuQmCC","aspectRatio":2,"src":"/static/55a94699f1c16ff59258cbb490d497eb/eb0de/01-cover.png","srcSet":"/static/55a94699f1c16ff59258cbb490d497eb/bd3a8/01-cover.png 250w,\n/static/55a94699f1c16ff59258cbb490d497eb/0757b/01-cover.png 500w,\n/static/55a94699f1c16ff59258cbb490d497eb/eb0de/01-cover.png 1000w,\n/static/55a94699f1c16ff59258cbb490d497eb/37d21/01-cover.png 1280w","sizes":"(max-width: 1000px) 100vw, 1000px"}}}}}},"pageContext":{"slug":"/blog/2020/printed-links-detection/"}},"staticQueryHashes":[]}